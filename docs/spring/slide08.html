<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>記述統計量</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/css/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/lib/font/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./myconf.css"/>
<link rel="stylesheet" href="./reveal.js/lib/css/zenburn.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = './reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">記述統計量</h1>
</div>
<div class="talk-subtitle">
    <p>基礎的な記述統計量とデータの集約</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  2020.06.12</p>
</div>

</section>

<section>
<section id="slide-orgfbcb628">
<h2 id="orgfbcb628">基礎的な記述統計量</h2>
<div class="outline-text-2" id="text-orgfbcb628">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org244e80c">
<h3 id="org244e80c">記述統計量</h3>
<ul>
<li><b>記述統計量</b> : (または要約統計量・基本統計量)
<ul>
<li>データを簡潔に要約して表すための統計値</li>
<li>その集団全体の特徴を表す重要な指標</li>
<li>ヒストグラム・密度関数・箱ひげ図などのグラフと併用</li>

</ul></li>
<li>比較的良く用いられる統計量を以下の観点で分類
<ul>
<li>モーメント</li>
<li>順序</li>
<li>頻度</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org348b684">
<h3 id="org348b684">記述統計量の推定</h3>
<ul>
<li>記述統計量は背後の確率分布(集団全体)で決まる量</li>
<li>一般に確率分布は未知</li>
<li>手に入るのは(少数の)サンプル(観測データ) <br />
(観測データを \(X_1,X_2,\dots,X_n\) で表す)</li>
<li>真の値と観測データによる推定には <b>差</b> がある</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgda3ea71">
<h3 id="orgda3ea71">独立同分布性</h3>
<ul>
<li>統計解析における重要な仮定とその帰結:
<ul>
<li>確率変数 \(X_{1},X_{2},\dotsc,X_{n}\) が <b>同分布</b> <br />
共通の平均 \(\mu\) および分散 \(\sigma^2\) を考えることができる <br />
(適切な次数のモーメントの存在を仮定)</li>
<li>確率変数 \(X_{1},X_{2},\dotsc,X_{n}\) が <b>独立同分布</b> <br />
標本平均はサンプル数 \(n\to\infty\) のとき確率1で真の平均に収束 <br />
<b>(大数の強法則)</b></li>

</ul></li>
<li>データは <b>偏っていない</b> ことを仮定している</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgee11348">
<h3 id="orgee11348">推定量の一致性</h3>
<ul>
<li>サンプル数が大きい場合に「まともな」推定量となる根拠の1つ
<ul>
<li><b>(強)一致性</b> (consistency): <br />
推定量がサンプル数 \(n\to\infty\) のとき確率1で真の値に収束する性質</li>
<li><b>(強)一致推定量</b> : 一致性をもつ推定量</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org99f336f">
<h3 id="org99f336f">推定量の不偏性</h3>
<ul>
<li>サンプル数が小さい場合の推定量の良さに関する性質の1つ
<ul>
<li><p>
<b>不偏性</b> (unbiasedness): <br />
推定量 \(\hat{\theta}\)
が不偏であるとは, \(\hat{\theta}\)
の平均が真の値 \(\theta\) となる性質
</p>
<div>
\begin{equation}
  \mathbb{E}[\hat{\theta}]=\theta
\end{equation}

</div></li>

<li><b>不偏推定量</b> : 不偏性をもつ推定量</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org54ef14f">
<h2 id="org54ef14f">&ldquo;モーメント&rdquo;に基づく記述統計量</h2>
<div class="outline-text-2" id="text-org54ef14f">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org93d9d5d">
<h3 id="org93d9d5d">平均</h3>
<ul>
<li><p>
<b>平均</b> (mean): 
</p>
<div>
\begin{equation}
  \mu=\mathbb{E}[X]
\end{equation}

</div></li>

<li><p>
<b>標本平均</b> (sample mean):
</p>
<div>
\begin{equation}
  \bar{X}
  =\frac{1}{n}\sum_{i=1}^{n}X_{i}
  =\frac{X_{1}+\dotsb+X_{n}}{n}
  % =\frac{X_1+X_2+\cdots+X_n}{n}
\end{equation}

</div>

<p>
データの代表値を表す記述統計量
</p></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgdd8c4c7">
<h3 id="orgdd8c4c7">分散・標準偏差</h3>
<ul>
<li><p>
<b>分散</b> (variance): 
</p>
<div>
\begin{equation}
  \mathrm{Var}(X)=\sigma^{2}=\mathbb{E}[(X-\mu)^{2}]
\end{equation}

</div></li>

<li><p>
<b>標本分散</b> (sample variance):
</p>
<div>
\begin{equation}
  S^{2}
  =\frac{1}{n}\sum_{i=1}^n(X_{i}-\bar{X})^{2}
  =\frac{(X_{1}-\bar{X})^{2}+\dotsb+(X_{n}-\bar{X})^{2}}{n}
  % =\frac{(X_1-\bar{X})^2+(X_2-\bar{X})^2+\cdots+(X_n-\bar{X})^2}{n}
\end{equation}

</div>

<p>
データのばらつき具合を表す記述統計量
</p></li>
<li><b>標本標準偏差</b> (sample standard deviation): <br />
標本分散の平方根</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org983d3bf">
<h3 id="org983d3bf">標本平均・分散の不偏性</h3>
<ul>
<li><p>
標本平均は \(\mu\) の <b>不偏推定量である</b>:
</p>
<div>
\begin{equation}
  \mathbb{E}[\bar{X}]=\mu
\end{equation}

</div></li>

<li><p>
標本分散は \(\sigma^2\) の <b>不偏推定量ではない</b>:
</p>
<div>
\begin{equation}
  \mathbb{E}[S^2]=\frac{n-1}{n}\sigma^2
\end{equation}

</div>

<p>
(標本分散は平均的には真の分散を <b>過小推定</b> する)
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org646c2b0">
<h3 id="org646c2b0">不偏分散</h3>
<ul>
<li>不偏性を担保した分散の推定量</li>
<li><p>
バイアス補正:
標本分散に \(n/(n-1)\) を乗じたもの
</p>
<div>
\begin{equation}
  s^2=\frac{n}{n-1}S^2=\frac{1}{n-1}\sum_{i=1}^n(X_i-\bar{X})^2
\end{equation}

</div>

<p>
は \(\sigma^2\) の不偏推定量となる
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org4f1f4fe">
<h3 id="org4f1f4fe">標本標準偏差</h3>
<ul>
<li>標本標準偏差: 通常, 不偏分散の平方根 \(s\) を指す</li>
<li>一般に \(s\) は標準偏差 \(\sigma\) の <b>不偏推定量ではない</b></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgfeca7b9">
<h3 id="orgfeca7b9">平均・分散・標準偏差の計算</h3>
<ul>
<li><p>
基本書式
</p>
<div class="org-src-container">

<pre><code class=" R" >mean(x, trim = 0, na.rm = FALSE, ...) # 標本平均
var(x, na.rm = FALSE, ... ) # 不偏分散
sd(x, na.rm = FALSE) # 標本標準偏差
</code></pre>
</div></li>
<li>関数の引数
<ul>
<li><code>x</code>: ベクトル，データフレームなど</li>
<li><code>na.rm</code>: 欠損値を取り除くか否か</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org49a3397">
<h3 id="org49a3397">標準化</h3>
<ul>
<li>複数データの分析のために単位や基準を揃える</li>
<li><p>
データ \(X_{1},X_{2},\dotsc,X_{n}\) の標準化:
</p>
<div>
\begin{equation}
  Z_{i}=\frac{X_i-\bar{X}}{s}\quad(i=1,2,\dotsc,n)
\end{equation}

</div>

<p>
( \(s\) の代わりに \(S\) で割って定義する文献もある)
</p></li>
<li>定義から \(Z_{1},Z_{2},\dotsc,Z_{n}\) の
標本平均は0, 不偏分散は1 に規格化される</li>
<li>\(Z_{i}\): <b>標準得点</b> あるいは <b>Zスコア</b></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org96d4811">
<h3 id="org96d4811">偏差値</h3>
<ul>
<li>別の基準での標準化
<ul>
<li>教育学や心理学では, 平均50, 標準偏差10が好まれる</li>

</ul></li>
<li><p>
標本平均50, 標準偏差10に線形変換:
</p>
<div>
\begin{equation}
  T_{i}=10Z_{i}+50\quad(i=1,\dotsc,n)
\end{equation}

</div></li>

<li>\(T_{i}\):
<b>偏差値得点</b> あるいは <b>Tスコア</b></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgbc27832">
<h3 id="orgbc27832">標準化の計算</h3>
<ul>
<li><p>
基本書式
</p>
<div class="org-src-container">

<pre><code class=" R" >scale(x, center = TRUE, scale = TRUE) # 標準化
10 * scale(x) + 50 # 偏差値得点に変換
</code></pre>
</div></li>
<li>関数の引数
<ul>
<li><code>x</code>: ベクトル，データフレームなど</li>
<li><code>center</code>: 中心化(平均0)するか否か</li>
<li><code>scale</code>: 正規化(分散1)するか否か</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgfafad15" data-background="#fef4f4">
<h2 id="orgfafad15">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org770f62b" data-background="#fef4f4">
<h3 id="org770f62b">練習問題</h3>
<ul>
<li><p>
東京都の気候データ (<code>tokyo_weather.csv</code>) の中の
気温, 日射量, 風速の項目について以下の問に答えよ．
</p>
<div class="org-src-container">

<pre><code class=" R" >myData &lt;- read.csv("data/tokyo_weather.csv", fileEncoding="utf8")
</code></pre>
</div>
<ul>
<li>全てのデータを用いて各項目の平均・分散・標準偏差を求めよ．(データ数365)</li>
<li>毎月5日のデータのみを用いて各項目の平均・分散・標準偏差を求めよ．(データ数12)</li>
<li>5の付く日(各月の5,15,25)のデータを用いて各項目の平均・分散・標準偏差を求めよ．(データ数36)</li>
<li>ランダムに選んだ36日分のデータで各項目の平均・分散・標準偏差を求めたとき，
推定量のばらつきを確認せよ．</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgf092237">
<h2 id="orgf092237">歪度と尖度</h2>
<div class="outline-text-2" id="text-orgf092237">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb56fa08">
<h3 id="orgb56fa08">歪度と尖度</h3>
<ul>
<li>正規分布からのずれを調べるための統計量</li>
<li>正規分布の特徴: 
<ul>
<li>確率分布のうち最も基本的なもの <b>(中心極限定理)</b></li>
<li>平均と分散を決めると完全に決定される</li>

</ul></li>
<li>正規分布に従うデータでは標本平均と標本分散(不偏分散)を考えれば十分</li>
<li>現実には正規分布では捉えきれない特徴をもつデータも多い</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc3a9165">
<h3 id="orgc3a9165">歪度</h3>
<ul>
<li>分布の非対称性を表す統計量</li>
<li><p>
<b>歪度</b> (skewness): 
平均 \(\mu\) , 分散 \(\sigma^2\) で
3次モーメントをもつ確率変数 \(X\) 
に対して以下で定義
</p>
<div>
\begin{equation}
  \mathrm{skewness}=\frac{\mathbb{E}[(X-\mu)^3]}{\sigma^3}
\end{equation}

</div></li>

<li>左右に対称的な分布の歪度は0 (正規分布の歪度は0)
<ul>
<li>歪度が正の場合: 分布の右の裾の方が重い</li>
<li>歪度が負の場合: 分布の左の裾の方が重い</li>

</ul></li>
<li>正の歪度をもつ分布の例:
<ul>
<li>ガンマ分布 \(\Gamma(\nu,\alpha)\) の歪度は \(2/\sqrt{\nu}\)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org903a967">
<h3 id="org903a967">尖度</h3>
<ul>
<li>平均の周囲の分布の尖り具合を表す統計量</li>
<li><p>
<b>尖度</b> (kurtosis):
4次のモーメントをもつ確率変数 \(X\)
</p>
<div>
\begin{equation}
  \mathrm{kurtosis}=\frac{\mathbb{E}[(X-\mu)^4]}{\sigma^4}
\end{equation}

</div></li>

<li><p>
<b>超過尖度</b> (excess kurtosis):
正規分布との比較のため尖度から正規分布の尖度3を引いた量
</p>
<div>
\begin{equation}
  \mathrm{excess\ kurtosis}=\frac{\mathbb{E}[(X-\mu)^4]}{\sigma^4}-3
\end{equation}

</div>

<p>
(こちらを単に尖度と呼ぶ文献もあるので注意)
</p></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org413c43b">
<h3 id="org413c43b">超過尖度</h3>
<ul>
<li>正規分布と比較して
<ul>
<li>超過尖度が正の場合: 平均の周囲の分布の形状が尖っている</li>
<li><p>
超過尖度が負の場合: 分布の形状は丸みを帯びている
</p>
<blockquote>
<p>
正の場合，正規分布に比べて平均まわりの密度が
分布の裾の方にまわっていることが多いため,
正規分布より裾が重いと解釈されることが多い
</p>
</blockquote></li>

</ul></li>
<li>正の超過尖度をもつ分布の例:
<ul>
<li>自由度 \(\nu>4\) をもつ \(t\) 分布 \(t(\nu)\) の超過尖度は \(6/(\nu-4)\) <br />
(\(\nu\leq 4\) のときは \(t(\nu)\) は4次モーメントをもたない)</li>
<li>ガンマ分布 \(\Gamma(\nu,\alpha)\) の超過尖度は \(6/\nu\)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<div class="leftcol">

<div id="orgf431127" class="figure">
<p><img src="figs/sk_tdist.png" alt="sk_tdist.png" width="100%" />
</p>
</div>

</div>
<div class="rightcol">

<div id="orge56e977" class="figure">
<p><img src="figs/sk_gamma.png" alt="sk_gamma.png" width="100%" />
</p>
</div>

</div>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org5bba045">
<h3 id="org5bba045">標本歪度と標本尖度</h3>
<ul>
<li>観測データ \(X_{1},X_{2},\dotsc,X_{n}\) からの歪度と尖度の推定</li>
<li><p>
<b>標本歪度</b> (sample skewness): 
</p>
<div>
\begin{equation}
  \mathrm{skewness}=\frac{\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^3}{s^3}
\end{equation}

</div></li>

<li><p>
<b>標本尖度</b> (sample kurtosis):
</p>
<div>
\begin{equation}
  \mathrm{kurtosis}=\frac{\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^4}{s^4}
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgad36114">
<h3 id="orgad36114">歪度と尖度の計算</h3>
<ul>
<li><p>
歪度・尖度を計算する関数はRの標準機能にはないので
<code>package::e1071</code> を利用 (自作してもよい)
</p>
<blockquote>
<p>
標本歪度・標本尖度の値は標本平均・分散に比べて
<b>ばらつきが大きい</b> ので，
サンプル数が少ない場合の計算結果の解釈には注意が必要
</p>
</blockquote></li>
<li><p>
基本書式
</p>
<div class="org-src-container">

<pre><code class=" R" >skewness(x, na.rm = FALSE, type = 3) # 標本歪度
kurtosis(x, na.rm = FALSE, type = 3) # 標本超過尖度 (尖度ではない)
</code></pre>
</div></li>
<li>関数の引数
<ul>
<li><code>x</code>: ベクトル，データフレームなど</li>
<li><code>na.rm</code>: 欠損値を取り除くか否か</li>
<li><code>type</code>: 計算法の指定(通常は既定値でよい)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgfc4bfd4" data-background="#fef4f4">
<h2 id="orgfc4bfd4">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge741c2e" data-background="#fef4f4">
<h3 id="orge741c2e">練習問題</h3>
<ul>
<li>東京都の気候データ (<code>tokyo_weather.csv</code>) の中の
気温, 日射量, 風速の項目について以下の問に答えよ．
<ul>
<li>全てのデータを用いて各項目の歪度と超過尖度を求めよ．(データ数365)</li>
<li>毎月5日のデータのみを用いて各項目の平均・分散・標準偏差を求めよ．(データ数12)</li>
<li>それぞれの値から正規分布から逸脱していると思われる項目はいずれか考察せよ．</li>
<li>各データのヒストグラムを描き，データから計算される平均と分散を持つ正規分布と比較せよ．</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org3c08428">
<h2 id="org3c08428">相関と共分散</h2>
<div class="outline-text-2" id="text-org3c08428">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgcbf502d">
<h3 id="orgcbf502d">共分散</h3>
<ul>
<li>複数のデータ間の関係を知るための記述統計量</li>
<li><p>
<b>共分散</b> (covariance):
</p>
<div>
\begin{equation}
  \mathrm{Cov}(X,Y)=\mathbb{E}[(X-\mathbb{E}[X])(Y-\mathbb{E}[Y])]
\end{equation}

</div></li>

<li><p>
<b>標本共分散</b> (sample covariance): <br />
\(X_1,X_2,\dots,X_n\) および \(Y_1,Y_2,\dots,Y_n\) に対して
</p>
<div>
\begin{equation}
  \mathrm{Cov}(X,Y)=\frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}{n-1}
\end{equation}

</div></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc2ae7df">
<h3 id="orgc2ae7df">相関</h3>
<ul>
<li>複数のデータ間の正規化した記述統計量</li>
<li><p>
<b>相関</b> (correlation): <br />
</p>
<div>
\begin{equation}
  \rho=\frac{\mathrm{Cov}(X,Y)}{\sqrt{\mathrm{Var}(X)\mathrm{Var}(Y)}}
\end{equation}

</div></li>

<li><p>
<b>標本相関</b> (sample correlation): <br />
\(X_1,X_2,\dots,X_n\) および \(Y_1,Y_2,\dots,Y_n\) に対して
</p>
<div>
\begin{equation}
  \rho=\frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}
  {\sqrt{\sum_{i=1}^n(X_i-\bar{X})^2}\sqrt{\sum_{i=1}^n(Y_i-\bar{Y})^2}}
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>直感的には2種類のデータ間の比例関係の大きさ</li>
<li>相関の値は \(-1\) 以上 \(1\) 以下
<ul>
<li>\(1\) に近いほど正の比例関係が強い</li>
<li>\(-1\) に近いほど負の比例関係が強い</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgabd27a5">
<h3 id="orgabd27a5">相関と共分散の計算</h3>
<ul>
<li><p>
基本書式
</p>
<div class="org-src-container">

<pre><code class=" R" >cov(x, y = NULL, use = "everything", 
    method = c("pearson", "kendall", "spearman")) # 共分散
cor(x, y = NULL, use = "everything", 
    method = c("pearson", "kendall", "spearman")) # 相関
</code></pre>
</div></li>
<li>関数の引数
<ul>
<li><code>x,y</code>: ベクトル，データフレームなど (データフレームの時は列間の共分散行列，相関行列を計算)</li>
<li><code>use</code>: 欠損値などの扱いに関する指定</li>
<li><code>method</code>: 計算法の指定(通常は既定値 <code>pearson</code> でよい)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgad8ef82" data-background="#fef4f4">
<h2 id="orgad8ef82">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc792cfc" data-background="#fef4f4">
<h3 id="orgc792cfc">練習問題</h3>
<ul>
<li>東京都の気候データ (<code>tokyo_weather.csv</code>) の中の
気温, 降水量, 日射量, 降雪量, 風速, 気圧, 湿度 (数値データ)
の項目について以下の問に答えよ．
<ul>
<li>それぞれの項目間の共分散，および相関を求めよ．</li>
<li>相関の高い項目の組(絶対値が大きい)，および相関の低い項目の組(0に近い)を求めよ．</li>
<li>その項目同士の散布図を描け．</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org047945a">
<h2 id="org047945a">&ldquo;順序&rdquo;に基づく統計量</h2>
<div class="outline-text-2" id="text-org047945a">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org37e2581">
<h3 id="org37e2581">中央値</h3>
<ul>
<li>データの順序にもとづく記述統計量</li>
<li><p>
<b>中央値</b> もしくは <b>メディアン</b> (median):
</p>
<div>
\begin{equation}
  X_{(1)}\leq X_{(2)}\leq\cdots\leq X_{(n)}
\end{equation}

</div>

<p>
データを昇順に並べ替えたとき中央にくる値
</p>
<ul>
<li>\(n\) が奇数の場合: \(X_{((n+1)/2)}\)</li>
<li>\(n\) が偶数の場合: \((X_{(n/2)}+X_{(n/2+1)})/2\)</li>

</ul></li>
<li>中央値は平均と同様にデータを代表する値</li>
<li>データ中の <b>外れ値</b> (異常な値)の影響を受けにくい</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgec8b9f3">
<h3 id="orgec8b9f3">分位点</h3>
<ul>
<li>\(100\alpha\) % <b>分位点</b> (percentile/quantile): <br />
メディアンの一般化</li>
<li>\(\alpha\in[0,1]\) に対して,
その点以下のデータの個数が全体の約 \(100\alpha\) % になるような点
<ul>
<li><b>第1四分位点</b>: 25%分位点</li>
<li><b>第2四分位点</b>: 50%分位点 (中央値と等価)</li>
<li><b>第3四分位点</b>: 75%分位点</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc63d5a3">
<h3 id="orgc63d5a3">中央値・分位点の計算</h3>
<ul>
<li><p>
基本書式
</p>
<div class="org-src-container">

<pre><code class=" R" >median(x, na.rm = FALSE, ...) # 中央値
quantile(x, probs = seq(0, 1, 0.25), na.rm = FALSE,
	 names = TRUE, type = 7, ...) # 分位点
summary(x) # 最大，最小，四分位点，平均を計算する
</code></pre>
</div></li>
<li>関数の引数
<ul>
<li><code>x</code>: ベクトル</li>
<li><code>na.rm</code>: 欠損値を取り除くか否か</li>
<li><code>probs</code>: 計算する分位点の値</li>
<li><code>names</code>: 出力に関する指定，多数の分位点を計算する場合は <code>FALSE</code> とした方がよい</li>
<li><code>type</code>: 計算法の指定( <code>help(quantile)</code> を参照)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge80d985">
<h3 id="orge80d985">連続分布の分位点</h3>
<ul>
<li>分位点は推定や検定において重要な役割を果たす</li>
<li><p>
連続分布の \(100\alpha\) <b>%分位点</b> :
</p>
<blockquote>
<p>
\(0<\alpha<1\) に対して，その分布に従う確率変数を \(X\) としたとき，
不等式
</p>
<div>
\begin{equation}
  P(X\leq x)\geq\alpha
\end{equation}

</div>

<p>
を満たす実数 \(x\) のうち最小のもの．
</p>

<p>
そのような実数は常に存在し, それを \(q_\alpha\) とすると
</p>
<div>
\begin{equation}
  P(X\leq q_\alpha)=\alpha
\end{equation}

</div>

<p>
が成り立つ．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
分位点の性質
</p>
<blockquote>
<p>
\(X_1,X_2,\dots,X_n\) が独立同分布な確率変数の列のとき,
\(X_1,X_2,\dots,X_n\) の \(100\alpha\) %分位点は，
\(n\to\infty\) のとき \(X_1,X_2,\dots,X_n\) の従う
分布の \(100\alpha\) %分位点の <b>一致推定量</b> となる．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org1ecc553">
<h3 id="org1ecc553">分布の分位点の計算</h3>
<ul>
<li><p>
基本書式
</p>
<div class="org-src-container">

<pre><code class=" R" ># 正規分布の例
qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)
# xxx分布の場合は以下の形式
qxxx(p, "分布の特性を決める option の指定") 
</code></pre>
</div></li>
<li>関数の引数
<ul>
<li><code>p</code>: 分位点 (100p%)</li>
<li><code>mean, sd</code>: 正規分布の特性を決めるoption</li>
<li><code>lower.tail</code>: <code>TRUE</code> なら \(P(X\le x)\) を計算，
<code>FALSE</code> なら逆</li>
<li><code>log.p</code>: 出力を対数とするか否か (値が小さい場合に利用)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb9b19a3">
<h3 id="orgb9b19a3">ばらつきの指標</h3>
<ul>
<li>分位点を利用したデータのばらつきの指標</li>
<li><b>範囲</b> (range): <br />
最大値と最小値の差 (外れ値の影響を大きく受ける)</li>
<li><b>四分位範囲</b> (interquantile range): <br />
第3四分位点と第1四分位点の差</li>
<li><b>中央絶対偏差</b> (median absolute deviation): <br />
\(X_1,X_2,\dots,X_n\) の中央値を \(m\) としたとき,
\(|X_1-m|,|X_2-m|,\dots,|X_n-m|\) の中央値</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org1150bfc">
<h2 id="org1150bfc">&ldquo;頻度&rdquo;に基づく統計量</h2>
<div class="outline-text-2" id="text-org1150bfc">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge5a64e0">
<h3 id="orge5a64e0">頻度に基づく統計量</h3>
<ul>
<li><b>最頻値</b> もしくは <b>モード</b> (mode): データの中で最も頻度が高く現れる値</li>
<li>データが有限個の値を取る場合に特に有効</li>
<li>データが連続で無限に多くの値を取ることができる場合には
注意が必要
<ul>
<li>連続なデータの場合でも有限個の観測データに対してモードは定義できる</li>
<li>ただし，偶々観測値として現れた値なのでその意味はよく考えなくてはならない</li>
<li>必要に応じて, 例えば区分的に集計するなどの工夫をすることもある</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgc9788eb" data-background="#fef4f4">
<h2 id="orgc9788eb">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgeb2842a" data-background="#fef4f4">
<h3 id="orgeb2842a">練習問題</h3>
<ul>
<li>東京都の気候データ (<code>tokyo_weather.csv</code>) の中の
気温(数値データ)と最多風向(ラベルデータ)を用いて
以下の問に答えよ．
<ul>
<li>全てのデータを用いて気温の四分位点を求めよ．(データ数365)</li>
<li>5の付く日(各月の5,15,25)の気温の四分位点を求めよ．(データ数36)</li>
<li>ランダムに選んだ36日分のデータで気温の四分位点がどのくらいばらつくか確認せよ．</li>
<li>風向の最頻値を求めなさい．</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/lib/js/head.min.js"></script>
<script src="./reveal.js/js/reveal.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: true,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,

overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'fade', // see README of reveal.js for options
transitionSpeed: 'default',

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/audio-slideshow/audio-slideshow.js', condition: function( ) { return !!document.body.classList && !Reveal.isSpeakerNotes(); } },
{ src: './reveal.js/plugin/anything/anything.js' },
{ src: './reveal.js/plugin/toc-progress/toc-progress.js', async: true, callback: function() { toc_progress.initialize('reduce', 'rgba(120,138,130,0.2)'); toc_progress.create(); } },
{ src: './reveal.js/plugin/jump/jump.js', async: true },
{ src: './reveal.js/plugin/quiz/js/quiz.js', async: true, callback: function() { prepareQuizzes({preventUnanswered: true, skipStartButton: true}); } },
{ src: './reveal.js/plugin/coursemod/coursemod.js', async: true },
{ src: './reveal.js/plugin/accessibility/helper.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }]

,audioStartAtFragment: true,
  audio: {
    advance: -1, autoplay: false, defaultDuration: 0, defaultAudios: false, playerOpacity: 0.8, playerStyle: 'position: fixed; bottom: 9.5vh; left: 0%; width: 30%; height:30px; z-index: 33;' },
anything: [
        // Following initialization code for class animate from anything-demo.html.
        // Copyright (c) 2016 Asvin Goel, under The MIT License (MIT).
	{className: "animate",  initialize: (function(container, options){
		Reveal.addEventListener( 'fragmentshown', function( event ) {
			if (typeof event.fragment.beginElement === "function" ) {
				event.fragment.beginElement();
			}
		});
		Reveal.addEventListener( 'fragmenthidden', function( event ) {
			if (event.fragment.hasAttribute('data-reverse') ) {
				var reverse = event.fragment.parentElement.querySelector('[id=\"' + event.fragment.getAttribute('data-reverse') + '\"]');
				if ( reverse && typeof reverse.beginElement === "function" ) {
					reverse.beginElement();
				}
			}
		});
		if ( container.getAttribute("data-svg-src") ) {
			var xhr = new XMLHttpRequest();
			xhr.onload = function() {
				if (xhr.readyState === 4) {
					var svg = container.querySelector('svg');
					container.removeChild( svg );
					container.innerHTML = xhr.responseText + container.innerHTML;
					if ( svg ) {
						container.querySelector('svg').innerHTML = container.querySelector('svg').innerHTML + svg.innerHTML;
					}
				}
				else {
					console.warn( "Failed to get file. ReadyState: " + xhr.readyState + ", Status: " + xhr.status);
				}
			};
			xhr.open( 'GET', container.getAttribute("data-svg-src"), true );
			xhr.send();
		}
	}) },
	{className: "randomPic",
	 defaults: {imgalt: "Dummy alt text",
		    imgcaption: "Image by {name}",
		    choices: [ {name: "dummyname", path: "dummypath"} ]},
	 initialize: (function(container, options){
	     var choice = Math.trunc( Math.random()*(options.choices.length) );
	     var img = "<img src='" + options.choices[choice].path + "' alt='" + options.choices[choice].imgalt + "' />";
	     var caption = options.imgcaption.replace(new RegExp('\{name\}', 'gm'), options.choices[choice].name);
	     container.innerHTML = img + caption;
	 }) },
	{className: "notes",
	 initialize: (function(container, options){
	     container.addEventListener('click', function(e) { RevealNotes.open(); });
	 }) }
],
coursemod: { enabled: true, shown: false },
});
</script>
</body>
</html>
