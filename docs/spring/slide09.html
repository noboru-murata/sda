<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>推定</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/css/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/lib/font/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./myconf.css"/>
<link rel="stylesheet" href="./reveal.js/lib/css/zenburn.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = './reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">推定</h1>
</div>
<div class="talk-subtitle">
    <p>確率分布を推定する</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  2019.06.14</p>
</div>

</section>

<section>
<section id="slide-org0a32b65">
<h2 id="org0a32b65">推定とは</h2>
<div class="outline-text-2" id="text-org0a32b65">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org7db15b7">
<h3 id="org7db15b7">統計解析の目標</h3>
<ul>
<li>観測データを確率変数の実現値と考えてモデル化</li>
<li>観測データの背後の確率分布を <b>推定</b>
<ul>
<li>分布のもつなんらかの特性量(平均や分散など)を評価する</li>
<li>分布そのものを決定する</li>

</ul></li>
<li>統計学で広く利用されている推定方法を説明</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2d584df">
<h3 id="org2d584df">推定の枠組</h3>
<ul>
<li>観測データは独立同分布な確率変数列 \(X_1,X_2,\dots,X_n\)</li>
<li>\(X_i\) の従う共通の分布 \(\mathcal{L}\) を想定</li>
<li>\(\mathcal{L}\)  としてすべての分布を考察対象とすることは困難
<ul>
<li>対象とする範囲が広くなりすぎる</li>
<li>データ数 \(n\) が大きくないと意味のある結論を導き出せない</li>

</ul></li>
<li>確率分布 \(\mathcal{L}\) を特徴づけるパラメータ \(\theta\) を考察対象
<ul>
<li>\(\mathcal{L}\) の平均・分散・歪度・尖度など</li>
<li>\(\mathcal{L}\) の <b>確率関数・確率密度関数のパラメータ</b></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgdf1a834">
<h2 id="orgdf1a834">点推定</h2>
<div class="outline-text-2" id="text-orgdf1a834">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org1872973">
<h3 id="org1872973">パラメータの点推定</h3>
<ul>
<li><p>
\(\mathcal{L}\) に含まれるパラメータ \(\theta\) を \(X_1,\dots,X_n\) の関数
</p>
<div>
\begin{equation}
  \hat{\theta}=\hat{\theta}(X_1,\dots,X_n)
\end{equation}

</div>
<p>
で推定すること
</p></li>
<li>\(\hat{\theta}\) を \(\theta\) の <b>推定量</b> と呼ぶ</li>
<li>記述統計量は分布のパラメータの推定量の一つ
<ul>
<li>例: \(\mathcal{L}\) の平均 \(\mu\) を
標本平均 \(\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i\) によって
推定することが点推定であり,
\(\bar{X}\) は \(\mu\) の推定量となる．</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org1d6f651">
<h3 id="org1d6f651">良い推定量</h3>
<ul>
<li>一般に1つのパラメータの推定量は無数に存在</li>
<li>推定量の良さを評価する基準が必要</li>
<li>代表的な基準: <b>不偏性・一致性</b>
<ul>
<li><p>
\(\hat{\theta}\) が \(\theta\) の不偏推定量:
</p>
<div>
\begin{equation}
  E[\hat{\theta}]=\theta
\end{equation}

</div></li>
<li><p>
\(\hat{\theta}\) が \(\theta\) の(強)一致推定量:
</p>
<div>
\begin{equation}
  \text{$\hat{\theta}$ が $\theta$ に収束する確率が1}\quad (n\to\infty)
\end{equation}

</div></li>
<li>例: 標本平均, 不偏分散はそれぞれ
\(\mathcal{L}\) の平均, 分散の不偏かつ一致性をもつ推定量</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgaa04597">
<h3 id="orgaa04597">良い不偏推定量</h3>
<ul>
<li>一般に不偏推定量も複数存在
<ul>
<li>例: \(\mathcal{L}\) の平均 \(\mu\) の不偏推定量:
<ul>
<li>標本平均 \(\bar{X}\)</li>
<li>\(X_1\)</li>
<li>\(X_1,\dots,X_n\) のメディアン
( \(\mathcal{L}\) が \(x=\mu\) に関して対称な場合)</li>

</ul></li>

</ul></li>
<li>不偏推定量の良さを評価する基準が必要</li>
<li><p>
<b>一様最小分散不偏推定量</b>:
\(\theta\) の任意の不偏推定量 \(\hat{\theta}'\) 
に対して推定値のばらつき(分散)が最も小さいもの
</p>
<div>
\begin{equation}
  \mathrm{Var}(\hat{\theta})\le\mathrm{Var}(\hat{\theta}')
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org281d6fd">
<h3 id="org281d6fd">Cramer-Raoの不等式</h3>
<p>
\(\mathcal{L}\) は1次元パラメータ \(\theta\) を含む連続分布とし，
その確率密度関数 \(f_\theta(x)\) は \(\theta\) に関して
偏微分可能であるとする．
このとき，緩やかな仮定の下で，
\(\theta\) の任意の不偏推定量 \(\hat{\theta}\) に対して
以下の不等式が成り立つ:
</p>
<div>
\begin{equation}%\label{cr-bound}
  \mathrm{Var}(\hat{\theta})\ge \frac{1}{nI(\theta)}.
\end{equation}

</div>
<p>
ただし
</p>
<div>
\begin{equation}
  I(\theta)=\int_{-\infty}^\infty
  \left(\frac{\partial}{\partial\theta}\log f_\theta(x)\right)^2
  f_\theta(x)dx.
\end{equation}

</div>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgeba4785">
<h3 id="orgeba4785">一様最小分散不偏推定量</h3>
<ul>
<li>定理の不等式: <b>Cramer-Raoの不等式</b></li>
<li>下界 \(1/(nI(\theta))\) : <b>Cramer-Rao下界</b></li>
<li>\(I(\theta)\) : <b>Fisher情報量</b></li>

</ul>

<p>
Cramer-Raoの不等式は
一様最小分散不偏推定量を見出す方法の1つとして利用できる．
</p>

<p>
\(\theta\) の不偏推定量 \(\hat{\theta}\) で
分散がCramer-Rao下界 \(1/(nI(\theta))\) に一致するものが存在すれば，
それは一様最小分散不偏推定量となる．
</p>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org9384fde">
<h3 id="org9384fde">例: 正規分布モデルの標本平均</h3>
<ul>
<li>\(\mathcal{L}\) が平均 \(\mu\) , 分散 \(\sigma^2\) の正規分布を考える</li>
<li><p>
平均パラメーター \(\mu\) に関するFisher情報量:
</p>
<div>
\begin{align}
  I(\mu)=\frac{1}{\sqrt{2\pi\sigma^2}}
  \int_{-\infty}^\infty\frac{(x-\mu)^2}{\sigma^4}
  e^{-\frac{(x-\mu)^2}{2\sigma^2}}dx
  =\frac{1}{\sigma^2}
\end{align}

</div></li>
<li>Cramer-Rao下界: \(\sigma^2/n\)</li>
<li>標本平均 \(\bar{X}\) の分散: \(\sigma^2/n\) (=Cramer-Rao下界)</li>
<li>\(\bar{X}\) は \(\mu\) の一様最小分散不偏推定量</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgac0d31c" data-background="#fef4f4">
<h3 id="orgac0d31c">演習</h3>
<ul>
<li><code>est-umvue.r</code> を確認しなさい．</li>
<li>一様乱数を用いて，以下の平均値の推定量の分散を比較しなさい．
<ul>
<li>標本平均</li>
<li>メディアン</li>
<li>最大値と最小値の平均</li>

</ul></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgf1d0548">
<h2 id="orgf1d0548">最尤法</h2>
<div class="outline-text-2" id="text-orgf1d0548">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org06c0695">
<h3 id="org06c0695">離散分布の場合</h3>
<ul>
<li>確率関数: \(f_{\boldsymbol{\theta}}(x)\)</li>
<li>確率関数のパラメータ: \(\boldsymbol{\theta}:=(\theta_1,\dots,\theta_p)\)</li>
<li><p>
観測値 \(X_1=x_1,X_2=x_2,\dots,X_n=x_n\) の同時確率:
</p>
<div>
\begin{align}
  & P(X_1=x_1,X_2=x_2,\dots,X_n=x_n)\\
  =&\prod_{i=1}^nP(X_i=x_i)\\
  =&
  \prod_{i=1}^nf_{\boldsymbol{\theta}}(x_i)
  =f_{\boldsymbol{\theta}}(x_1)\cdot
  f_{\boldsymbol{\theta}}(x_2)\cdots
  f_{\boldsymbol{\theta}}(x_n)
\end{align}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc8d12a4">
<h3 id="orgc8d12a4">尤度関数</h3>
<ul>
<li><p>
\(\boldsymbol{\theta}\) <b>の尤度</b> \(L(\boldsymbol{\theta})\) : 
パラメータ \(\boldsymbol{\theta}\) に対して
観測データ \(X_1,X_2,\dots,X_n\) が得られる理論上の確率: 
</p>
<div>
\begin{equation}
  L(\boldsymbol{\theta})
  :=\prod_{i=1}^nf_{\boldsymbol{\theta}}(X_i)
\end{equation}

</div></li>
<li>観測データ \(X_1,X_2,\dots,X_n\) が現れるのに
パラメータ \(\boldsymbol{\theta}\) の値が
どの程度尤もらしいかを測る尺度</li>
<li><b>尤度関数</b> \(L(\boldsymbol{\theta})\) :
\(\boldsymbol{\theta}\) の関数とみなしたもの</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org6b8de0f">
<h3 id="org6b8de0f">最尤法</h3>
<ul>
<li><b>最尤法</b>: 観測データに対して「最も尤もらしい」パラメータ
を \(\boldsymbol{\theta}\) の推定量として採用する方法</li>
<li><p>
<b>最尤推定量</b> \(\hat{\boldsymbol{\theta}}\) :
尤度関数を最大とする \(\boldsymbol{\theta}\) 
</p>
<div>
\begin{equation}
  L(\hat{\boldsymbol{\theta}})
  =\max_{\boldsymbol{\theta}\in\Theta}L(\boldsymbol{\theta}).
\end{equation}

</div>
<p>
または以下のように表現
</p>
<div>
\begin{equation}
  \hat{\boldsymbol{\theta}}
  =\arg\max_{\boldsymbol{\theta}\in\Theta}L(\boldsymbol{\theta}).
\end{equation}

</div>
<p>
\(\Theta\) は尤度関数の定義域
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2d5a6a9">
<h3 id="org2d5a6a9">最尤推定量の計算</h3>
<ul>
<li>扱い易い和の形に直すために対数を取ることが多い</li>
<li><p>
<b>対数尤度関数</b>:
</p>
<div>
\begin{equation}
  \ell(\boldsymbol{\theta})
  :=\log L(\boldsymbol{\theta})
  =\sum_{i=1}^n\log f_{\boldsymbol{\theta}}(X_i).
\end{equation}

</div>
<ul>
<li>対数関数は狭義増加</li>
<li>\(\ell(\boldsymbol{\theta})\) の最大化と \(L(\boldsymbol{\theta})\) の最大化は同義</li>

</ul></li>
<li>広い範囲の確率分布に対して最尤推定量は <b>一致性を持つ</b></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org4774cf8">
<h3 id="org4774cf8">連続分布の場合</h3>
<ul>
<li><b>確率密度関数</b> を用いて尤度を定義</li>
<li>確率密度関数: \(f_{\boldsymbol{\theta}}(x)\)</li>
<li><p>
<b>尤度関数</b>: 
</p>
<div>
\begin{equation}
  L(\boldsymbol{\theta})
  =\prod_{i=1}^nf_{\boldsymbol{\theta}}(x_i)
  =f_{\boldsymbol{\theta}}(x_1)\cdot
  f_{\boldsymbol{\theta}}(x_2)\cdots
  f_{\boldsymbol{\theta}}(x_n)
\end{equation}

</div></li>
<li><p>
<b>対数尤度関数</b>:
</p>
<div>
\begin{equation}
  \ell(\boldsymbol{\theta})
  :=\log L(\boldsymbol{\theta})
  =\sum_{i=1}^n\log f_{\boldsymbol{\theta}}(X_i)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org08098f8">
<h3 id="org08098f8">例: Poisson分布</h3>
<ul>
<li>\(\mathcal{L}\) をパラメータ \(\lambda>0\) のPoisson分布でモデル化</li>
<li><p>
対数尤度関数 (未知パラメータ: \(\lambda\) )
</p>
<div>
\begin{equation}
  \ell(\lambda)=\sum_{i=1}^n\log\frac{\lambda^{X_i}}{X_i!}e^{-\lambda}
  =\sum_{i=1}^n(X_i\log\lambda-\log X_i!)-n\lambda
\end{equation}

</div></li>
<li>少なくとも1つの \(i\) について \(X_i>0\) を仮定する</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org9116130">
<h3 id="org9116130">例: Poisson分布 (つづき)</h3>
<ul>
<li><p>
\(\ell(\lambda)\) の微分: 
</p>
<div>
\begin{equation}
  \ell'(\lambda)=\frac{1}{\lambda}\sum_{i=1}^nX_i-n,\quad
  \ell''(\lambda)=-\frac{1}{\lambda^2}\sum_{i=1}^nX_i<0
\end{equation}

</div></li>
<li>方程式 \(\ell'(\lambda)=0\) の解が \(\ell(\lambda)\) を最大化</li>
<li><p>
\(\lambda\) の最尤推定量:
</p>
<div>
\begin{equation}
  \hat{\lambda}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org81e14aa">
<h3 id="org81e14aa">例: 指数分布</h3>
<ul>
<li>\(\mathcal{L}\) をパラメータ \(\lambda>0\) の指数分布でモデル化</li>
<li><p>
対数尤度関数 (未知パラメータ: \(\lambda\) )
</p>
<div>
\begin{equation}
  \ell(\lambda)=\sum_{i=1}^n\log\lambda e^{-\lambda X_i}
  =n\log\lambda-\lambda\sum_{i=1}^nX_i
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3f66a70">
<h3 id="org3f66a70">例: 指数分布 (つづき)</h3>
<ul>
<li><p>
\(\ell(\lambda)\) の微分: 
</p>
<div>
\begin{equation}
  \ell'(\lambda)=\frac{n}{\lambda}-\sum_{i=1}^nX_i,\quad
  \ell''(\lambda)=-\frac{n}{\lambda^2}<0
\end{equation}

</div></li>
<li>方程式 \(\ell'(\lambda)=0\) の解が \(\ell(\lambda)\) を最大化</li>
<li><p>
\(\lambda\) の最尤推定量:
</p>
<div>
\begin{equation}
  \hat{\lambda}=\frac{1}{\frac{1}{n}\sum_{i=1}^nX_i}
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org0492ef8">
<h3 id="org0492ef8">例: ガンマ分布</h3>
<ul>
<li>\(\mathcal{L}\) をパラメータ \(\nu,\alpha>0\) のガンマ分布でモデル化</li>
<li><p>
対数尤度関数 (未知パラメータ: \(\nu,\alpha\) )
</p>
<div>
\begin{align}
  \ell(\nu,\alpha)
  &=\sum_{i=1}^n\log\frac{\alpha^\nu}{\Gamma(\nu)}X_i^{\nu-1}e^{-\alpha X_i}\\
  &=n\nu\log\alpha-n\log\Gamma(\nu)+\sum_{i=1}^n\{(\nu-1)\log X_i-\alpha X_i\}
\end{align}

</div></li>
<li>\(\ell(\nu,\alpha)\) を最大化する \(\nu,\alpha\) は解析的に求まらないので実際の計算では数値的に求める</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf9ddf34" data-background="#fef4f4">
<h3 id="orgf9ddf34">演習</h3>
<ul>
<li><code>est-mle.r</code> を確認しなさい．</li>
<li>自身で収集したデータについてモデル化し，
最尤推定量を求めなさい．</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org4099ad3">
<h2 id="org4099ad3">区間推定</h2>
<div class="outline-text-2" id="text-org4099ad3">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org4c9c9a1">
<h3 id="org4c9c9a1">推定誤差</h3>
<ul>
<li>推定量 \(\hat{\theta}\) には推定誤差が必ず存在</li>
<li>推定結果の定量的な評価には推定誤差の評価が重要</li>
<li><p>
「誤差 \(\hat{\theta}-\theta\) が
区間 \([l,u]\) の外側(内側)にある確率が \(\alpha\) (\(1{-}\alpha\)) 以下 」 
</p>
<div>
\begin{equation}
  P(l\le\hat{\theta}-\theta\le u)\ge 1{-}\alpha
\end{equation}

</div></li>
<li><p>
「 \(\theta\) が含まれる確率が \(1{-}\alpha\) 以上となるような区間
\([\hat{\theta}-u,\hat{\theta}-l]\) を推定」
</p>
<div>
\begin{equation}
  P(\hat{\theta}-u\le\theta\le \hat{\theta}-l)\ge 1{-}\alpha
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgeaa5159">
<h3 id="orgeaa5159">区間推定</h3>
<ul>
<li><p>
<b>区間推定</b>: 
未知パラメータ \(\theta\) とある値 \(\alpha\in(0,1)\) に対して
以下を満たす確率変数 \(L,U\) を観測データから求めること
</p>
<div>
\begin{equation}
  P(L\le\theta\le U)\ge 1{-}\alpha
\end{equation}

</div>
<ul>
<li>区間 \([L,U]\) : \(1{-}\alpha\) <b>信頼区間</b> (\(100(1{-}\alpha)\) % と書くことも多い)</li>
<li>\(L\) : \(1{-}\alpha\) <b>下側信頼限界</b></li>
<li>\(U\) : \(1{-}\alpha\) <b>上側信頼限界</b></li>
<li>\(1{-}\alpha\) : <b>信頼係数</b>
(\(\alpha=0.01,0.05,0.1\) とすることが多い)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb8b3e96">
<h3 id="orgb8b3e96">信頼区間</h3>
<ul>
<li>信頼区間は幅が狭いほど推定精度が良い<br />
(真のパラメータが取りうる値の範囲を限定することになるため)</li>
<li><p>
最も推定精度の良い \(1{-}\alpha\) 信頼区間 \([L,U]\) は
</p>
<div>
\begin{equation}
  P(L\le\theta\le U)=1{-}\alpha
\end{equation}

</div>
<p>
(信頼区間の幅が狭いほど確率 \(P(L\le\theta\le U)\) は小さくなるため)
</p></li>
<li>実行可能である限り
\(1{-}\alpha\) 信頼区間 \([L,U]\) は上式を満たすように
\(L,U\) を決定する</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgae02450">
<h2 id="orgae02450">正規母集団の区間推定</h2>
<div class="outline-text-2" id="text-orgae02450">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf4e327c">
<h3 id="orgf4e327c">正規分布の性質1</h3>
<p>
正規分布に従う独立な確率変数の重み付き和は正規分布に従う
</p>
<ul>
<li>\(Z_1,Z_2,\dots,Z_k\) を独立な確率変数列とし，
各 \(i=1,2,\dots,k\) に対して \(Z_i\) は平均 \(\mu_i\) ，
分散 \(\sigma_i^2\) の正規分布に従うとする．
このとき \(a_0,a_1,\dots,a_k\) を \((k+1)\) 個の0でない実数とすると，
\(a_0+\sum_{i=1}^ka_iZ_i\) は
平均 \(a_0+\sum_{i=1}^ka_i\mu_i\) ，
分散 \(\sum_{i=1}^ka_i^2\sigma_i^2\) の正規分布に従う．</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org16ae02f">
<h3 id="org16ae02f">正規分布の性質2</h3>
<ul>
<li><p>
\(k=n\), \(\mu_i=\mu\), \(\sigma_i^2=\sigma^2\), \(a_0=0\),
\(a_i=1/n\;(i=1,\dots,n)\)
</p>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i \quad\text{(標本平均)}
\end{equation}

</div>
<p>
は平均 \(\mu\) , 分散 \(\sigma^2/n\) の正規分布に従う
</p></li>
<li><p>
\(k=1\) , \(\mu_1=\mu\) , \(\sigma_1^2=\sigma^2/n\) ,
\(a_0=-\sqrt{n}\mu/\sigma\) , \(a_1=\sqrt{n}/\sigma\)
</p>
<div>
\begin{equation}
  \frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
\end{equation}

</div>
<p>
は標準正規分布に従う
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orga855d38">
<h3 id="orga855d38">平均の区間推定 (分散既知)</h3>
<ul>
<li><p>
\(z_{1{-}\alpha/2}\) を標準正規分布の
\(1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\Bigl(-z_{1{-}\alpha/2}\le\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
    \le z_{1{-}\alpha/2}\Bigr)=1{-}\alpha
\end{equation}

</div></li>
<li><p>
\(\mu\) について解くと
</p>
<div>
\begin{equation}
  P\Bigl(\bar{X}-z_{1{-}\alpha/2}\cdot\sigma/\sqrt{n}\le\mu
    \le\bar{X}+z_{1{-}\alpha/2}\cdot\sigma/\sqrt{n} \Bigr)=1{-}\alpha
\end{equation}

</div></li>
<li><p>
\(\sigma\) が既知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b>:
</p>
<div>
\begin{equation}
  \bigl[\bar{X}-z_{1{-}\alpha/2}\cdot\sigma/\sqrt{n},\;
  \bar{X}+z_{1{-}\alpha/2}\cdot\sigma/\sqrt{n}\bigr]
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org9cf44da">
<h3 id="org9cf44da">正規分布の性質3</h3>
<ul>
<li><p>
\(X_1,X_2,\dots,X_n\) は独立同分布な確率変数列で，
平均 \(\mu\) ，分散 \(\sigma^2\) の正規分布に従うとする．
不偏分散を
</p>
<div>
\begin{equation}
  s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2
\end{equation}

</div>
<p>
とすると， \(\bar{X}\) と \(s^2\) は独立であり，
確率変数 \((n{-}1)s^2/\sigma^2\) は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う．
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf1a2820">
<h3 id="orgf1a2820">正規分布の性質4</h3>
<ul>
<li><p>
上の命題と \(\sqrt{n}(\bar{X}-\mu)/\sigma\) が標準正規分布に従うこ
とから，
確率変数
</p>
<div>
\begin{equation}
  \frac{\sqrt{n}(\bar{X}-\mu)}{s}
  \left(=\frac{\sqrt{n}(\bar{X}-\mu)/\sigma}
    {\sqrt{\frac{(n{-}1)s^2}{\sigma^2}\Big/(n{-}1)}}\right)
\end{equation}

</div>
<p>
は自由度 \(n{-}1\) の \(t\) 分布に従う
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org15223b1">
<h3 id="org15223b1">平均の区間推定 (分散未知)</h3>
<ul>
<li><p>
\(t_{1{-}\alpha/2}(n{-}1)\) を自由度 \(n{-}1\) の \(t\) 分布の
\(1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\Bigl(-t_{1{-}\alpha/2}(n{-}1)\le\frac{\sqrt{n}(\bar{X}-\mu)}{s}
    \le t_{1{-}\alpha/2}(n{-}1)\Bigr)=1{-}\alpha
\end{equation}

</div></li>
<li><p>
分散が未知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b>:
</p>
<div>
\begin{equation}
  \bigl[\bar{X}-t_{1{-}\alpha/2}(n{-}1)\cdot s/\sqrt{n},\;
  \bar{X}+t_{1{-}\alpha/2}(n{-}1)\cdot s/\sqrt{n}\bigr]
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org9dd541c">
<h3 id="org9dd541c">正規分布の性質5</h3>
<ul>
<li>\((n{-}1)s^2/\sigma^2\) は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う</li>
<li><p>
\(\chi^2_{\alpha/2}(n{-}1)\) ,  \(\chi^2_{1{-}\alpha/2}(n{-}1)\) を
それぞれ自由度 \(n{-}1\) の \(\chi^2\) 分布の
 \(\alpha/2, 1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}\label{eq:svar-chisq}
  P\Bigl(\chi^2_{\alpha/2}(n{-}1)\le(n{-}1)s^2/\sigma^2
    \le \chi^2_{1{-}\alpha/2}(n{-}1)\Bigr)
  =1{-}\alpha
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgfa54392">
<h3 id="orgfa54392">分散の区間推定</h3>
<ul>
<li><p>
\(\sigma^2\) について解いて
</p>
<div>
\begin{multline}
  P\Bigl((n{-}1)s^2/\chi^2_{1{-}\alpha/2}(n{-}1)
    \le \sigma^2\le(n{-}1)s^2/\chi^2_{\alpha/2}(n{-}1)\Bigr)\\
  =1{-}\alpha
\end{multline}

</div></li>
<li><p>
\(\sigma^2\) の \(1{-}\alpha\) <b>信頼区間</b>: 
</p>
<div>
\begin{equation}
  \bigl[(n{-}1)s^2/\chi^2_{1{-}\alpha/2}(n{-}1),(n{-}1)s^2/\chi^2_{\alpha/2}(n{-}1)\bigr]
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org0b809dd" data-background="#fef4f4">
<h3 id="org0b809dd">演習</h3>
<ul>
<li><code>est-ci-mean.r</code> を確認しなさい．</li>
<li><code>est-ci-mean-unknown.r</code> を確認しなさい．</li>
<li><code>est-ci-var.r</code> を確認しなさい．</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org655ffd2">
<h2 id="org655ffd2">漸近正規性による区間推定</h2>
<div class="outline-text-2" id="text-org655ffd2">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org6cdb098">
<h3 id="org6cdb098">推定量の漸近正規性</h3>
<ul>
<li><p>
<b>漸近正規性</b>: 多くの推定量 \(\hat{\theta}\) の分布は正規分布で近似できる
</p>
<ul>
<li>モーメントに基づく記述統計量は漸近正規性をもつ</li>
<li>最尤推定量は広い範囲の確率分布に対して漸近正規性をもつ</li>

</ul>
<p>
いずれも中心極限定理にもとづく
</p></li>
<li>正規分布を用いて近似的に信頼区間を構成することができる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgd386687">
<h3 id="orgd386687">標本平均の漸近正規性</h3>
<ul>
<li><p>
確率分布 \(\mathcal{L}\) が2次のモーメントを持てば，
\(\mathcal{L}\) の平均 \(\mu\) の推定量である標本平均
は漸近正規性をもつ
</p>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div></li>
<li>\(\mathcal{L}\) の標準偏差を \(\sigma\) とすれば, 
任意の \(a\le b\) に対して以下が成立する</li>

</ul>
<p>
( \(\phi\) は標準正規分布の確率密度関数)
</p>
<div>
\begin{equation}\label{ci-clt}
  P\left(a\le\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
    \le b\right)\to\int_a^b\phi(x)dx\quad(n\to\infty)
\end{equation}

</div>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org1423e1d">
<h3 id="org1423e1d">標本平均の漸近正規性 (つづき)</h3>
<ul>
<li><p>
\(z_{1{-}\alpha/2}\) を標準正規分布の
\(1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\left(-z_{1{-}\alpha/2}\le\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
    \le z_{1{-}\alpha/2}\right)\to1{-}\alpha\quad(n\to\infty)
\end{equation}

</div></li>
<li><p>
\(\mu\) について解くと
</p>
<div>
\begin{multline}
  P\left(\bar{X}-z_{1{-}\alpha/2}\cdot\sigma/\sqrt{n}
    \le\mu \le\bar{X}+z_{1{-}\alpha/2}\cdot\sigma/\sqrt{n} \right)\\
  \to1{-}\alpha\quad(n\to\infty)
\end{multline}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org5abb7c6">
<h3 id="org5abb7c6">平均の区間推定 (分散既知)</h3>
<ul>
<li><p>
\(\sigma\) が既知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b>:
</p>
<div>
\begin{equation}
  \left[\bar{X}-z_{1{-}\alpha/2}\cdot\sigma/\sqrt{n},\;
  \bar{X}+z_{1{-}\alpha/2}\cdot\sigma/\sqrt{n}\right]
\end{equation}

</div>
<p>
(サンプル数 \(n\) が十分大きい場合に近似的に正しい)
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgd9da140">
<h3 id="orgd9da140">平均の区間推定 (分散未知)</h3>
<ul>
<li>\(\sigma\) をその一致推定量 \(\hat{\sigma}\) で置き換えてもそのまま成立する</li>
<li><p>
\(\sigma\) が未知の場合の平均 \(\mu\) の \(1{-}\alpha\) <b>信頼区間</b>:
</p>
<div>
\begin{equation}
  \left[\bar{X}-z_{1{-}\alpha/2}\cdot\hat{\sigma}/\sqrt{n},\;
  \bar{X}+z_{1{-}\alpha/2}\cdot\hat{\sigma}/\sqrt{n}\right]
\end{equation}

</div>
<p>
(サンプル数 \(n\) が十分大きい場合に近似的に正しい)
</p></li>
<li><p>
\(\hat{\sigma}\) としては例えば不偏分散の平方根を用いる:
</p>
<div>
\begin{equation}
  \hat{\sigma}=\sqrt{\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2}
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc38e363" data-background="#fef4f4">
<h3 id="orgc38e363">演習</h3>
<ul>
<li><code>est-ci-mean-asymp.r</code> を確認しなさい．</li>
<li><code>est-ci-mle.r</code> を確認しなさい．</li>
<li>自身で収集したデータについてモデル化し，
区間推定を行いなさい．</li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/lib/js/head.min.js"></script>
<script src="./reveal.js/js/reveal.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: true,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,

overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'fade', // see README of reveal.js for options
transitionSpeed: 'default',

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/audio-slideshow/audio-slideshow.js', condition: function( ) { return !!document.body.classList && !Reveal.isSpeakerNotes(); } },
{ src: './reveal.js/plugin/anything/anything.js' },
{ src: './reveal.js/plugin/toc-progress/toc-progress.js', async: true, callback: function() { toc_progress.initialize('reduce', 'rgba(120,138,130,0.2)'); toc_progress.create(); } },
{ src: './reveal.js/plugin/jump/jump.js', async: true },
{ src: './reveal.js/plugin/quiz/js/quiz.js', async: true, callback: function() { prepareQuizzes({preventUnanswered: true, skipStartButton: true}); } },
{ src: './reveal.js/plugin/coursemod/coursemod.js', async: true },
{ src: './reveal.js/plugin/accessibility/helper.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }]

,audioStartAtFragment: true,
  audio: {
    advance: -1, autoplay: false, defaultDuration: 0, defaultAudios: false, playerOpacity: 0.8, playerStyle: 'position: fixed; bottom: 9.5vh; left: 0%; width: 30%; height:30px; z-index: 33;' },
anything: [
        // Following initialization code for class animate from anything-demo.html.
        // Copyright (c) 2016 Asvin Goel, under The MIT License (MIT).
	{className: "animate",  initialize: (function(container, options){
		Reveal.addEventListener( 'fragmentshown', function( event ) {
			if (typeof event.fragment.beginElement === "function" ) {
				event.fragment.beginElement();
			}
		});
		Reveal.addEventListener( 'fragmenthidden', function( event ) {
			if (event.fragment.hasAttribute('data-reverse') ) {
				var reverse = event.fragment.parentElement.querySelector('[id=\"' + event.fragment.getAttribute('data-reverse') + '\"]');
				if ( reverse && typeof reverse.beginElement === "function" ) {
					reverse.beginElement();
				}
			}
		});
		if ( container.getAttribute("data-svg-src") ) {
			var xhr = new XMLHttpRequest();
			xhr.onload = function() {
				if (xhr.readyState === 4) {
					var svg = container.querySelector('svg');
					container.removeChild( svg );
					container.innerHTML = xhr.responseText + container.innerHTML;
					if ( svg ) {
						container.querySelector('svg').innerHTML = container.querySelector('svg').innerHTML + svg.innerHTML;
					}
				}
				else {
					console.warn( "Failed to get file. ReadyState: " + xhr.readyState + ", Status: " + xhr.status);
				}
			};
			xhr.open( 'GET', container.getAttribute("data-svg-src"), true );
			xhr.send();
		}
	}) },
	{className: "randomPic",
	 defaults: {imgalt: "Dummy alt text",
		    imgcaption: "Image by {name}",
		    choices: [ {name: "dummyname", path: "dummypath"} ]},
	 initialize: (function(container, options){
	     var choice = Math.trunc( Math.random()*(options.choices.length) );
	     var img = "<img src='" + options.choices[choice].path + "' alt='" + options.choices[choice].imgalt + "' />";
	     var caption = options.imgcaption.replace(new RegExp('\{name\}', 'gm'), options.choices[choice].name);
	     container.innerHTML = img + caption;
	 }) },
	{className: "notes",
	 initialize: (function(container, options){
	     container.addEventListener('click', function(e) { RevealNotes.open(); });
	 }) }
],
coursemod: { enabled: true, shown: false },
});
</script>
</body>
</html>
