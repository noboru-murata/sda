<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>データ構造と関数</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/css/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/oer-reveal.css"/>

<link rel="stylesheet" href="./reveal.js/lib/font/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./myconf.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = './reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body prefix="dc: http://purl.org/dc/terms/ cc: http://creativecommons.org/ns#">
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">データ構造と関数</h1>
</div>
<div class="talk-subtitle">
    <p></p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  2019.04.19</p>
</div>

</section>

<section>
<section id="slide-org1539941">
<h2 id="org1539941">データ構造</h2>
<div class="outline-text-2" id="text-org1539941">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org061b2c2">
<h3 id="org061b2c2">Rに用意されているデータ構造</h3>
<p>
下記は代表的なもので，これ以外にもある
</p>
<ul>
<li>ベクトル (vector)</li>
<li>行列 (matrix)</li>
<li>リスト (list)</li>
<li>データフレーム (data frame)</li>
<li>配列 (array)</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org4f99fc6">
<h2 id="org4f99fc6">データ構造: ベクトル</h2>
<div class="outline-text-2" id="text-org4f99fc6">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge6a71b2">
<h3 id="orge6a71b2">ベクトルとは</h3>
<ul>
<li>スカラー値の集合</li>
<li><p>
スカラー値として扱われるものには
</p>
<ul>
<li>数値 (実数や複素数)</li>
<li>文字列 (&rsquo;や&ldquo;で囲まれた文字．&rdquo;foo&ldquo;，&rdquo;bar&ldquo;など)</li>
<li>論理値 ( <code>TRUE</code> , <code>FALSE</code> )</li>

</ul>
<p>
などが含まれる 
</p></li>
<li>Rオブジェクトの多くはベクトルとして扱われる<br>
(スカラー値は長さ1のベクトルとして扱われる)</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org5e15b16">
<h3 id="org5e15b16">ベクトルの生成と操作</h3>
<ul>
<li><p>
数値や文字列の要素からなるベクトルの生成:
</p>
<div class="org-src-container">

<pre  class="src src-R">c(1,-2,3,-4,5) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#25968;&#20516;&#12398;&#12505;&#12463;&#12488;&#12523;</span>
c(<span style="color: #98C379;">"Alice"</span>,<span style="color: #98C379;">"Bob"</span>,<span style="color: #98C379;">"Cathy"</span>,<span style="color: #98C379;">"David"</span>) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#25991;&#23383;&#21015;&#12398;&#12505;&#12463;&#12488;&#12523;</span>
</pre>
</div>

<pre class="example">
[1]  1 -2  3 -4  5
[1] "Alice" "Bob"   "Cathy" "David"
</pre></li>

<li><p>
ベクトルの要素の取得:
</p>
<div class="org-src-container">

<pre  class="src src-R">x[i] <span style="color: #5C6370;"># </span><span style="color: #5C6370;">x&#12398;&#31532;i&#35201;&#32032; (&#12505;&#12463;&#12488;&#12523;&#12398;&#28155;&#12360;&#23383;&#12399;1&#12363;&#12425;&#22987;&#12414;&#12427;)</span>
x[c(1,3,4)] <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#35079;&#25968;&#12398;&#35201;&#32032;</span>
            <span style="color: #5C6370;"># </span><span style="color: #5C6370;">= c(x[1],x[3],x[4])</span>
</pre>
</div></li>
<li><p>
ベクトル <code>x</code> の長さの取得:
</p>
<div class="org-src-container">

<pre  class="src src-R">length(x)    
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2f9a642">
<h3 id="org2f9a642">ベクトルの作成と操作 (その2)</h3>
<ul>
<li><p>
実数 <code>x</code> から <code>y</code> まで
1ずつ変化する要素を持つベクトル:
</p>
<div class="org-src-container">

<pre  class="src src-R">x:y <span style="color: #5C6370;"># </span><span style="color: #5C6370;">x &lt; y &#12398;&#22580;&#21512;&#12399;1&#12378;&#12388;&#22679;&#21152;&#65292;&#36870;&#12398;&#22580;&#21512;&#12399;1&#12378;&#12388;&#28187;&#23569;</span>
</pre>
</div></li>

</ul>

<ul>
<li><p>
実数 <code>x</code> から <code>y</code> まで
<code>a</code> ずつ変化する要素を持つベクトル:
</p>
<div class="org-src-container">

<pre  class="src src-R">seq(x,y,by=a) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">from=x,to=y &#12392;&#26126;&#31034;&#12375;&#12390;&#12418;&#12424;&#12356;    </span>
</pre>
</div></li>
<li><p>
ベクトル <code>x</code> を <code>n</code> 回繰り返した要素をもつベクトル:
</p>
<div class="org-src-container">

<pre  class="src src-R">rep(x,n) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#38263;&#12373;&#12399; length(x) * n &#12392;&#12394;&#12427;</span>
</pre>
</div></li>
<li><p>
ベクトル <code>x</code> とベクトル <code>y</code> の結合:
</p>
<div class="org-src-container">

<pre  class="src src-R">c(x,y)    
</pre>
</div></li>
<li><p>
ベクトル <code>x</code> の反転:
</p>
<div class="org-src-container">

<pre  class="src src-R">rev(x)    
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge19ed7f" data-background="#fef4f4">
<h3 id="orge19ed7f">演習</h3>
<ul>
<li>以下に示すベクトルを作成せよ.
<ul>
<li>1から10までの自然数のベクトル</li>
<li>1以上30以下の奇数を昇順に並べたベクトル</li>
<li>すべての要素が1からなる長さ10のベクトル</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org17ae1eb">
<h2 id="org17ae1eb">データ構造: 行列</h2>
<div class="outline-text-2" id="text-org17ae1eb">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org3c832a7">
<h3 id="org3c832a7">行列の生成と操作</h3>
<ul>
<li><p>
すべての要素が <code>a</code> である \(m\times n\) 行列:
</p>
<div class="org-src-container">

<pre  class="src src-R">matrix(a,m,n)     
</pre>
</div></li>
<li><p>
長さ \(mn\) のベクトル <code>x</code> を \(m\times n\) 行列に変換:
</p>

<div>
\begin{equation}
  x=(x_{11},\dots,x_{m1},x_{21},\dots,x_{2n},\dots,x_{m1},\dots,x_{mn})
\end{equation}

</div>

<div class="org-src-container">

<pre  class="src src-R">matrix(x,m,n)    
</pre>
</div></li>
<li><p>
関数 <code>as.vector()</code> を用いたベクトル化:
</p>
<div class="org-src-container">

<pre  class="src src-R">x <span style="color: #56B6C2;">&lt;-</span> as.vector(matrix(x,m,n))
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org95cc410">
<h3 id="org95cc410">行列の生成と操作 (その2)</h3>
<ul>
<li><p>
行列のサイズの取得: 
</p>
<div class="org-src-container">

<pre  class="src src-R">dim(X) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#38263;&#12373;2&#12398;&#12505;&#12463;&#12488;&#12523;</span>
nrow(X) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#34892;&#25968;</span>
ncol(X) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#21015;&#25968;</span>
</pre>
</div></li>
<li><p>
関数 <code>dim()</code> によるベクトルから行列への変換:
</p>
<div class="org-src-container">

<pre  class="src src-R">dim(x) <span style="color: #56B6C2;">&lt;-</span> c(m,n) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">= matrix(x,m,n)</span>
</pre>
</div></li>
<li><p>
行列の成分の取得:
</p>
<div class="org-src-container">

<pre  class="src src-R">X[i,j] <span style="color: #5C6370;"># </span><span style="color: #5C6370;">(i,j)&#25104;&#20998;</span>
X[i, ] <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#31532;i&#34892;</span>
X[ ,j] <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#31532;j&#21015;</span>
X[c(1,3),2:4] <span style="color: #5C6370;"># </span><span style="color: #5C6370;">1&#65292;3&#34892;&#12392;&#65292;2&#12316;4&#21015;&#12363;&#12425;&#12394;&#12427;&#37096;&#20998;&#34892;&#21015;</span>
</pre>
</div></li>
<li><p>
長さが等しい複数のベクトルの結合:
</p>
<div class="org-src-container">

<pre  class="src src-R">rbind(x, y, ...) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#34892;&#12505;&#12463;&#12488;&#12523;&#12392;&#12375;&#12390;&#32080;&#21512;</span>
cbind(x, y, ...) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#21015;&#12505;&#12463;&#12488;&#12523;&#12392;&#12375;&#12390;&#32080;&#21512;</span>
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc3c6da8">
<h3 id="orgc3c6da8">行列の生成と操作 - 補足</h3>
<ul>
<li>関数 <code>cbind()/rbind()</code> は行数/列数が等しい行列を横/縦に結合できる</li>
<li>行列の高次元版として配列(array)が用意されている</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2745dc5" data-background="#fef4f4">
<h3 id="org2745dc5">演習</h3>
<ul>
<li><p>
以下に示す行列を作成せよ．
</p>

<div>
\begin{equation*}
  \begin{pmatrix}
    1  & 2  & 3  \\
    4  & 5  & 6 
  \end{pmatrix}
\end{equation*}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orge72a250">
<h2 id="orge72a250">データ構造: リスト</h2>
<div class="outline-text-2" id="text-orge72a250">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org7d0aff5">
<h3 id="org7d0aff5">リストとは</h3>
<ul>
<li>異なる構造のデータを1つにまとめたもの</li>
<li>本講義のデータ解析ではほとんど用いない</li>
<li>Rの関数の操作ではときどき必要</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org187c4ae">
<h3 id="org187c4ae">リストの生成と操作</h3>
<ul>
<li><p>
リストの生成:
</p>
<div class="org-src-container">

<pre  class="src src-R">L <span style="color: #56B6C2;">&lt;-</span> list(x,y) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">x,y&#12434;&#35201;&#32032;&#12392;&#12377;&#12427;&#12522;&#12473;&#12488;</span>
L[[i]] <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#12522;&#12473;&#12488;&#12398;&#31532;i&#35201;&#32032;</span>
</pre>
</div></li>
<li><p>
リストの各要素に名前を付与:
</p>
<div class="org-src-container">

<pre  class="src src-R">L1 <span style="color: #56B6C2;">&lt;-</span> list(first=x, second=y) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#26041;&#27861;1</span>
L2 <span style="color: #56B6C2;">&lt;-</span> list(x,y)               <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#26041;&#27861;2</span>
names(L2) <span style="color: #56B6C2;">&lt;-</span> c(<span style="color: #98C379;">"first"</span>,<span style="color: #98C379;">"second"</span>)
</pre>
</div></li>
<li><p>
名前によるリストの要素の取得:
</p>
<div class="org-src-container">

<pre  class="src src-R">L1$first      <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#26041;&#27861;1</span>
L2[[<span style="color: #98C379;">"first"</span>]] <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#26041;&#27861;2</span>
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org0799238">
<h2 id="org0799238">データ構造: データフレーム</h2>
<div class="outline-text-2" id="text-org0799238">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org264aa9b">
<h3 id="org264aa9b">データフレームとは</h3>
<ul>
<li>リストにおける各要素が長さの等しいベクトルであるもの</li>
<li>複数の個体について，いくつかの属性を集計したデータ</li>
<li>例: ある小学校の1年生の身長・体重・性別・血液型など
<ul>
<li>各成分はある属性に関する観測データに対応</li>
<li>個体数は集計項目に関わらず変化しないが，
集計項目によっては定量的データ・定性的データの違いが出てくるので
データ型は変わりうる</li>

</ul></li>
<li>実データの多くは表形式で与えられるため，
実データに則したデータ構造</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org1d53b2c">
<h3 id="org1d53b2c">データフレームの生成と操作</h3>
<ul>
<li><p>
データフレームの生成:
</p>
<div class="org-src-container">

<pre  class="src src-R">data.frame(A=x,B=y,C=z) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">x,y,z&#12399;&#21516;&#12376;&#38263;&#12373;&#65292;&#21508;&#21015;&#12399;A,B,C&#12392;&#12356;&#12358;&#21517;&#21069;</span>
</pre>
</div></li>
<li>データフレームはリストでもある<br>
リストと同様にして各変数にアクセスできる</li>
<li>データフレームは行列でもある<br>
行数がベクトルの長さ(個体数), 列数が変数の個数(観測項目の数)の行列と同様にアクセスできる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgab71aa1" data-background="#fef4f4">
<h3 id="orgab71aa1">演習</h3>
<ul>
<li><p>
次の表に対応するデータフレームを作成せよ．
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">国語</th>
<th scope="col" class="org-right">数学</th>
<th scope="col" class="org-right">英語</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Alice</td>
<td class="org-right">90</td>
<td class="org-right">25</td>
<td class="org-right">65</td>
</tr>

<tr>
<td class="org-left">Bob</td>
<td class="org-right">80</td>
<td class="org-right">50</td>
<td class="org-right">100</td>
</tr>

<tr>
<td class="org-left">Cathy</td>
<td class="org-right">70</td>
<td class="org-right">75</td>
<td class="org-right">70</td>
</tr>

<tr>
<td class="org-left">David</td>
<td class="org-right">60</td>
<td class="org-right">100</td>
<td class="org-right">40</td>
</tr>
</tbody>
</table></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org63d5ff3">
<h2 id="org63d5ff3">ベクトルの計算</h2>
<div class="outline-text-2" id="text-org63d5ff3">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org0c4b5bb">
<h3 id="org0c4b5bb">ベクトルの表記</h3>
<ul>
<li>ベクトルは太字で表し，要素は下付き添字で表す</li>
<li><p>
例えば \(k\) 次元ベクトルは以下のように表す
</p>

<div>
\begin{equation}
  \boldsymbol{a}
  =(a_{1},a_{2},\dotsc,a_{k})
\end{equation}

</div></li>
<li>ベクトル \(\boldsymbol{a}\) の第 \(i\) 成分を \((\boldsymbol{a})_{i}\) のように書くこともある</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org991436a">
<h3 id="org991436a">ベクトルの加法</h3>
<ul>
<li><p>
同じ長さのベクトルの和および差は，
数値の和と差のように扱うことができる
</p>

<div>
\begin{equation}
  \boldsymbol{a}\pm\boldsymbol{b}
  =(a_{1}\pm b_{1},a_{2}\pm b_{2},\dotsc,a_{k}\pm b_{k})
\end{equation}

</div>

<div class="org-src-container">

<pre  class="src src-R">a + b <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#21516;&#12376;&#38263;&#12373;&#12398;&#12505;&#12463;&#12488;&#12523; a,b &#12398;&#21644;</span>
a - b <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#12505;&#12463;&#12488;&#12523;&#12398;&#24046;</span>
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf787e39">
<h3 id="orgf787e39">ベクトルの乗法 (2種類)</h3>
<ul>
<li><p>
同じ長さの2つのベクトル \(\boldsymbol{a},\boldsymbol{b}\) の
成分ごとの積(Hadamard積)を計算する
</p>

<div>
\begin{equation}
  \boldsymbol{a}\circ\boldsymbol{b}
  =(a_{1}b_{1},a_{2}b_{2},\dotsc,a_{k}b_{k})
\end{equation}

</div>

<div class="org-src-container">

<pre  class="src src-R">a * b <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#12505;&#12463;&#12488;&#12523;&#12398;&#25104;&#20998;&#12372;&#12392;&#12398;&#31309;</span>
</pre>
</div></li>
<li><p>
ベクトルの内積を計算する
</p>

<div>
\begin{equation}
  \boldsymbol{a}\cdot\boldsymbol{b}
  =\sum_{i=1}^{k}a_{i}b_{i}
\end{equation}

</div>

<div class="org-src-container">

<pre  class="src src-R">a <span style="color: #56B6C2;">%*%</span> b <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#12505;&#12463;&#12488;&#12523;&#12398;&#20869;&#31309;</span>
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org9ddfb56">
<h3 id="org9ddfb56">初等関数の適用</h3>
<ul>
<li>ベクトルに初等関数( \(\sin,\exp,\dots\) など)を適用すると, 
成分ごとに計算した結果が返される</li>
<li><p>
例えばベクトル \(\boldsymbol{a}\) に関数 \(\sin\) を適用した
結果は
</p>

<div>
\begin{equation}
  \sin(\boldsymbol{a})=(\sin(a_1),\dots,\sin(a_k))
\end{equation}

</div>

<p>
となる
</p>
<div class="org-src-container">

<pre  class="src src-R">sin(a) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#25104;&#20998;&#12372;&#12392;&#12395;&#35336;&#31639;&#12373;&#12428;&#12427;&#65294;sin(a)[i]=sin(a[i])</span>
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org00f3335" data-background="#fef4f4">
<h3 id="org00f3335">演習</h3>
<ul>
<li>以下に示すベクトルを作成せよ.
<ul>
<li>1から10までの2乗値からなるベクトル</li>
<li>0度から30度刻みで360度まで正弦関数の値を並べたベクトル</li>
<li>公比10の1から10000までの等比数列からなるベクトル</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org848ad8a">
<h2 id="org848ad8a">行列の計算</h2>
<div class="outline-text-2" id="text-org848ad8a">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orga8fd2d0">
<h3 id="orga8fd2d0">行列の表記</h3>
<ul>
<li>行列は大文字で表し，要素は下付き添字で表す</li>
<li><p>
例えば \(m\times n\) 行列は
</p>

<div>
\begin{equation}
  A
  =
  \begin{pmatrix}
    a_{11}&a_{12}&\dots&a_{1n}\\
    a_{21}&a_{22}&\dots&a_{2n}\\
    \vdots&&\ddots&\vdots\\
    a_{m1}&a_{m2}&\dots&a_{mn}
  \end{pmatrix}
\end{equation}

</div>

<p>
のように表す
</p></li>
<li>行列 \(A\) の \(ij\) 成分を \((A)_{ij}\) のように書くこともある</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org458fba9">
<h3 id="org458fba9">行列の加法</h3>
<ul>
<li><p>
同じ大きさの行列の和および差
</p>

<div>
\begin{equation}
  (A\pm B)_{ij}=a_{ij}\pm b_{ij}
\end{equation}

</div>

<p>
は，ベクトルと同じように記述することができる
</p>
<div class="org-src-container">

<pre  class="src src-R">A + B <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#21516;&#12376;&#12469;&#12452;&#12474;&#12398;&#34892;&#21015;&#12398;&#21644;</span>
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgcf1fb60">
<h3 id="orgcf1fb60">行列の乗法 (2種類)</h3>
<ul>
<li><p>
同じ大きさの行列の成分ごとの積(Hadamard積)を計算する
</p>

<div>
\begin{equation}
  (A\circ B)_{ij}=a_{ij}b_{ij}
\end{equation}

</div>

<div class="org-src-container">

<pre  class="src src-R">A * B <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#34892;&#21015;&#12398;&#25104;&#20998;&#12372;&#12392;&#12398;&#31309;</span>
</pre>
</div></li>
<li><p>
\(n\times m\) 型行列 \(A\) と \(m\times l\) 型行列 \(B\) の
積 \(AB\) を計算する
</p>

<div>
\begin{equation}
  (AB)_{ij}=\sum_{k=1}^{m}a_{ik}b_{kj}
  \quad\text{($AB$は$n\times l$行列)}
\end{equation}

</div>

<div class="org-src-container">

<pre  class="src src-R">A <span style="color: #56B6C2;">%*%</span> B <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#34892;&#21015;&#12398;&#31309;</span>
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org43bcf2e">
<h3 id="org43bcf2e">初等関数の適用</h3>
<ul>
<li>行列に初等関数( \(\sin,\exp,\dots\) など)を適用すると，
成分ごとに計算した結果が返される</li>
<li><p>
例えば行列 \(A\) に関数 \(\sin\) を適用した
結果の \((i,j)\) 成分は
</p>

<div>
\begin{equation}
  (\sin(A))_{ij}=\sin(a_{ij})
\end{equation}

</div>

<p>
で与えられる
</p>
<div class="org-src-container">

<pre  class="src src-R">sin(A) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#25104;&#20998;&#12372;&#12392;&#12395;&#35336;&#31639;&#12373;&#12428;&#12427;&#65294;&#12469;&#12452;&#12474;&#12399;&#34892;&#21015;A&#12392;&#21516;&#12376;&#65294;sin(A)[i,j]=sin(A[i,j])</span>
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org4af19a4">
<h3 id="org4af19a4">行列式，トレース，逆行列</h3>
<ul>
<li><p>
正方行列 \(A\) の行列式 \(\det(A)\) を計算する
</p>
<div class="org-src-container">

<pre  class="src src-R">det(A) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#34892;&#21015;&#24335;</span>
</pre>
</div></li>
<li><p>
\(n\) 次正方行列 \(A\) のトレース(対角成分の総和)
</p>

<div>
\begin{equation}
  \mathrm{trace}(A)=\sum_{i=1}^na_{ii}
\end{equation}

</div>

<p>
は，
行列の対角成分を取り出す <code>diag()</code> と
ベクトルの総和を計算する <code>sum()</code> を組み合わせて計算する
</p>
<div class="org-src-container">

<pre  class="src src-R">sum(diag(A)) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#34892;&#21015;&#12398;&#12488;&#12524;&#12540;&#12473;</span>
</pre>
</div></li>
<li><p>
正則な行列 \(A\) の逆行列 \(A^{-1}\) は関数 <code>solve()</code> で計算する
</p>
<div class="org-src-container">

<pre  class="src src-R">solve(A) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#36870;&#34892;&#21015;</span>
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge300c66" data-background="#fef4f4">
<h3 id="orge300c66">演習</h3>
<ul>
<li><p>
適当な2次正方行列 \(A\) を作成し，
Hamilton-Cayleyの定理
</p>

<div>
\begin{equation}
  A^2-\mathrm{trace}(A)A+\det(A)E_2=O
\end{equation}

</div>

<p>
の成立を確認せよ．<br>
ただし \(E_2\) は2次単位行列，\(O\) は2次正方零行列である．
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org6340447">
<h2 id="org6340447">ベクトルと行列の計算</h2>
<div class="outline-text-2" id="text-org6340447">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org852c2b5">
<h3 id="org852c2b5">ベクトルと行列の乗法</h3>
<ul>
<li>R言語においては，
列ベクトル・行ベクトルという区別はなく，
単一のベクトルという概念で扱われている</li>
<li>行列とベクトルの積においては，
行列のどちらからベクトルを掛けるかによって自動的に列ベクトルか行ベクトルか適切な方で扱われる</li>
<li>ベクトルも行列の一種であり計算結果は行列として表現されることに注意する</li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org344fb40">
<h3 id="org344fb40">連立方程式</h3>
<ul>
<li><p>
\(A\) が \(n\) 次正則行列，
\(\boldsymbol{b}\) が \(n\) 次元列ベクトルのとき，
\(\boldsymbol{x}\) に関する連立1次方程式
</p>

<div>
\begin{equation}
  A\boldsymbol{x}=\boldsymbol{b}
\end{equation}

</div>

<p>
は解 \(\boldsymbol{x}=A^{-1}\boldsymbol{b}\) をもつが，
この解は関数 <code>solve()</code> によって計算できる
</p>
<div class="org-src-container">

<pre  class="src src-R">x <span style="color: #56B6C2;">&lt;-</span> solve(A, b)    
</pre>
</div></li>
<li>ベクトル \(\boldsymbol{b}\) は行数 \(n\) の行列でも可能</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge057ff5" data-background="#fef4f4">
<h3 id="orge057ff5">演習</h3>
<ul>
<li><p>
適当な3次正方行列 \(A\) と3次元ベクトル \(\boldsymbol{b}\) を作成し，
\(\boldsymbol{x}\) に関する連立1次方程式
</p>

<div>
\begin{equation}
  A\boldsymbol{x}=\boldsymbol{b}
\end{equation}

</div>

<p>
を解け．
</p></li>
<li><p>
上の \(A\) と \(\boldsymbol{b}\) を用いて
</p>
<div class="org-src-container">

<pre  class="src src-R">A <span style="color: #56B6C2;">%*%</span> b + b <span style="color: #56B6C2;">%*%</span> A   
</pre>
</div>
<p>
を計算せよ(エラーになる)．なぜそうなるか理由を考えよ．
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orge8d912c">
<h2 id="orge8d912c">関数定義</h2>
<div class="outline-text-2" id="text-orge8d912c">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org6e7a588">
<h3 id="org6e7a588">関数定義</h3>
<ul>
<li>多くの計算機言語と同様にRでも自作関数を定義できる</li>
<li>自作関数の定義には関数 <code>function()</code> を利用する</li>
<li><p>
例: 半径 r から球の体積と表面積を求める
</p>
<div class="org-src-container">

<pre  class="src src-R"><span style="color: #61AFEF;">myfunc</span> <span style="color: #56B6C2;">&lt;-</span> <span style="color: #C678DD;">function</span>(r){
    V <span style="color: #56B6C2;">&lt;-</span> (4/3) * pi * r^3 <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#29699;&#12398;&#20307;&#31309;</span>
    S <span style="color: #56B6C2;">&lt;-</span> 4 * pi * r^2     <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#29699;&#12398;&#34920;&#38754;&#31309;</span>
    out <span style="color: #56B6C2;">&lt;-</span> c(V,S)
    names(out) <span style="color: #56B6C2;">&lt;-</span> c(<span style="color: #98C379;">"volume"</span>, <span style="color: #98C379;">"area"</span>) 
    <span style="color: #5C6370;">## </span><span style="color: #5C6370;">&#36820;&#12426;&#20516;&#12395;&#21517;&#21069;&#12434;&#12388;&#12369;&#12427;</span>
    <span style="color: #C678DD;">return</span>(out)
}
myfunc(1) <span style="color: #5C6370;"># </span><span style="color: #5C6370;">&#23455;&#34892;</span>
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org6e86749" data-background="#fef4f4">
<h3 id="org6e86749">演習</h3>
<ul>
<li>三角形の3辺の長さ \(x,y,z\) を与えると面積 \(S\) を計算する関数を作成せよ．</li>
<li>そのコードをarea.Rという名前のファイルで保存せよ．</li>
<li><p>
関数 <code>source()</code> で上記のファイルを読み込んで，
\(x=3\), \(y=4\), \(z=5\) として計算してみよ．<br>
なお``ヘロンの公式&rsquo;&rsquo;より
</p>

<div>
\begin{equation}
  S=\sqrt{s(s-x)(s-y)(s-z)},\qquad
  s=\frac{x+y+z}{2}
\end{equation}

</div>

<p>
が成り立つ．
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org97f9cd5">
<h2 id="org97f9cd5">制御構造</h2>
<div class="outline-text-2" id="text-org97f9cd5">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org1e2122c">
<h3 id="org1e2122c">制御文</h3>
<ul>
<li>最適化や数値計算などを行うためには，
条件分岐や繰り返しを行うための仕組みが必要となる</li>
<li><p>
R言語を含む多くの計算機言語では
</p>
<ul>
<li><code>if</code>  (条件分岐)</li>
<li><code>for</code>  (繰り返し・回数指定)</li>
<li><code>while</code>  (繰り返し・条件指定)</li>

</ul>
<p>
を用いた構文が用意されているが，
これを制御文と言う 
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgfb99e0d">
<h3 id="orgfb99e0d"><code>if</code> 文</h3>
<ul>
<li><p>
条件Aが満たされる場合プログラムXを実行する
</p>
<div class="org-src-container">

<pre  class="src src-R"><span style="color: #C678DD;">if</span>(&#26465;&#20214;A) &#12503;&#12525;&#12464;&#12521;&#12512;X
</pre>
</div></li>
<li><p>
条件Aが満たされない場合は
プログラムYを実行することを追加する
</p>
<div class="org-src-container">

<pre  class="src src-R"><span style="color: #C678DD;">if</span>(&#26465;&#20214;A) &#12503;&#12525;&#12464;&#12521;&#12512;X <span style="color: #C678DD;">else</span> &#12503;&#12525;&#12464;&#12521;&#12512;Y    
</pre>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org1c64ffc">
<h3 id="org1c64ffc"><code>for</code> 文</h3>
<ul>
<li><p>
<code>M</code> をベクトルとし，
変数 <code>i</code> が <code>M</code> の要素となる値すべてを動きながら
プログラムXを繰り返し実行する
</p>
<div class="org-src-container">

<pre  class="src src-R"><span style="color: #C678DD;">for</span>(i <span style="color: #C678DD;">in</span> M) &#12503;&#12525;&#12464;&#12521;&#12512;X
</pre>
</div></li>
<li>プログラムXは通常変数 <code>i</code> によって実行内容が変わる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org5b9b096">
<h3 id="org5b9b096"><code>while</code> 文</h3>
<ul>
<li><p>
条件Aが満たされる限りプログラムXを繰り返し実行する
</p>
<div class="org-src-container">

<pre  class="src src-R"><span style="color: #C678DD;">while</span>(&#26465;&#20214;A) &#12503;&#12525;&#12464;&#12521;&#12512;X
</pre>
</div></li>
<li>プログラムXは通常実行するたびに実行内容が変わり，
いつか条件Aが満たされなくなるように書く</li>
<li>参考: <code>repeat</code> 文というのある</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc9a443f" data-background="#fef4f4">
<h3 id="orgc9a443f">演習</h3>
<ul>
<li><code>for</code> 文を用いて以下の計算をする関数を作成し，
正しく動作するか適当な値を入れて確認せよ．
<ul>
<li>正の整数 \(n\) から階乗 \(n!\) を計算する．</li>
<li><p>
行列 \(X\) が与えられたとき，各列の平均を計算する．<br>
(動作確認は, 例えば以下の行列を利用せよ)
</p>

<div>
\begin{equation}
  X=
  \begin{pmatrix}
    1  & 2  & 3  \\
    4  & 5  & 6  \\
    7  & 8  & 9  
  \end{pmatrix}
\end{equation}

</div></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org9fd5f9e" data-background="#fef4f4">
<h3 id="org9fd5f9e">演習</h3>
<ul>
<li><code>for</code> 文の問題で作成したそれぞれの関数が，
以下の処理をできるように <code>if</code> 文を用いて修正せよ．
<ul>
<li>\(n=0\) の場合にも関数が正しく動作する( \(0!=1\) )．</li>
<li>\(X\) がベクトルの場合でも正しく動作する．</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org7b6a484" data-background="#fef4f4">
<h3 id="org7b6a484">演習</h3>
<ul>
<li><code>while</code> 文を用いて以下の計算をする関数を作成し，
正しく動作するか適当な数値を入れて確認せよ．
<ul>
<li>正の整数 \(n\) から \(n!\) を計算する．</li>
<li>正の実数 \(x\) から \(x\leq n\) を満たす最小の整数 \(n\) を計算する．</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/js/reveal.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: true,
fragmentInURL: true,
pdfSeparateFragments: false,

overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'fade', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
{ src: './reveal.js/plugin/coursemod/coursemod.js', async: true },
{ src: './reveal.js/plugin/quiz/js/quiz.js', async: true, callback: function() { prepareQuizzes({preventUnanswered: true}); } },
{ src: './reveal.js/plugin/jump/jump.js', async: true },
 { src: './reveal.js/plugin/toc-progress/toc-progress.js', async: true, callback: function() { toc_progress.initialize('reduce', 'rgba(120,138,130,0.2)'); toc_progress.create(); } },
 { src: './reveal.js/plugin/anything/anything.js' },
 { src: './reveal.js/plugin/audio-slideshow/audio-slideshow.js', condition: function( ) { return !!document.body.classList && !Reveal.isSpeakerNotes(); } },
 { src: './reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } }]
,audio: {
    advance: -1, autoplay: true, defaultDuration: 0, defaultAudios: false, playerOpacity: 0.3, playerStyle: 'position: fixed; bottom: 9.5vh; left: 0%; width: 30%; height:30px; z-index: 33;' },
  anything: [
	{className: "animate",  initialize: (function(container, options){
		Reveal.addEventListener( 'fragmentshown', function( event ) {
			if (typeof event.fragment.beginElement === "function" ) {
				event.fragment.beginElement();
			}
		});
		Reveal.addEventListener( 'fragmenthidden', function( event ) {
			if (event.fragment.hasAttribute('data-reverse') ) {
				var reverse = event.fragment.parentElement.querySelector('[id=\"' + event.fragment.getAttribute('data-reverse') + '\"]');
				if ( reverse && typeof reverse.beginElement === "function" ) {
					reverse.beginElement();
				}
			}
		});
		if ( container.getAttribute("data-svg-src") ) {
			var xhr = new XMLHttpRequest();
			xhr.onload = function() {
				if (xhr.readyState === 4) {
					var svg = container.querySelector('svg');
					container.removeChild( svg );
					container.innerHTML = xhr.responseText + container.innerHTML;
					if ( svg ) {
						container.querySelector('svg').innerHTML = container.querySelector('svg').innerHTML + svg.innerHTML;
					}
				}
				else {
					console.warn( "Failed to get file. ReadyState: " + xhr.readyState + ", Status: " + xhr.status);
				}
			};
			xhr.open( 'GET', container.getAttribute("data-svg-src"), true );
			xhr.send();
		}
	}) },
	{className: "randomPic",
	 defaults: {imgalt: "Dummy alt text",
		    imgcaption: "Image by {name}",
		    choices: [ {name: "dummyname", path: "dummypath"} ]},
	 initialize: (function(container, options){
	     var choice = Math.trunc( Math.random()*(options.choices.length) );
	     var img = "<img data-src='" + options.choices[choice].path + "' alt='" + options.choices[choice].imgalt + "' />";
	     var caption = options.imgcaption.replace(new RegExp('\{name\}', 'gm'), options.choices[choice].name);
	     container.innerHTML = img + caption;
	 }) },
	{className: "notes",
	 initialize: (function(container, options){
	     container.addEventListener('click', function(e) { RevealNotes.open(); });
	 }) }
],
  coursemod: { enabled: true, shown: false }});
</script>
</body>
</html>
