#+TITLE: 検定
#+SUBTITLE: 仮説の正当性をデータから検証する
#+AUTHOR: 村田 昇
#+EMAIL: noboru.murata@eb.waseda.ac.jp
#+DATE: 2020.06.26
:reveal:
# #+INCLUDE: "~/.emacs.d/oer-reveal-org/config-de.org"
#+INCLUDE: "./myconf.org"
#+STARTUP: hidestars content
# C-c C-x C-v でinlineを切り替え
# <l C-i でlatex block
# C-c '
#+OPTIONS: date:t H:4 num:nil toc:nil \n:nil
#+OPTIONS: @:t ::t |:t ^:t -:t f:t *:t TeX:t LaTeX:t 
#+OPTIONS: skip:nil d:nil todo:t pri:nil tags:not-in-toc
#+PROPERTY: header-args:R :session *R* :cache yes 
#+PROPERTY: header-args:R+ :exports both :results output
#+PROPERTY: header-args:R+ :tangle no
#+PROPERTY: header-args:latex :exports results :results raw

#+begin_src R :exports none
  setwd("~/Desktop/lectures/u-tokyo/spring/slide")
#+end_src
#+begin_src R :exports none :tangle yes
  ### 第10回 演習問題解答例
#+end_src
:end:

* 検定とは
** 統計的仮説検定
   - ある現象・母集団に対して仮定された仮説の真偽を，
     データに基づいて統計的に検証する方法
     #+begin_quote
     例: 
     新しい薬の効能が古い薬よりも優れていること(仮説)を
     薬の治験結果(データ)から検証したい
     #+end_quote
   - 推定と大きく異なるのは, 
     母集団の分布に対して何らかの *仮説* を考えるところ

** 検定の基本的手続き
   - 仮説を立てる
   - 仮説が正しい場合に *検定統計量* が従う標本分布を調べる
   - 実際のデータから検定統計量の値を計算する
   - 計算された検定統計量の値は
     仮説が正しいと考えるに十分高い確率で
     起こるかどうかを判断する

** 検定の用語
   - *帰無仮説*
     #+begin_quote
     検定統計量の分布を予想するために立てる仮説
     #+end_quote
   - *対立仮説*
     #+begin_quote
    「帰無仮説が誤っているときに起こりうるシナリオ」として想定する仮説
     #+end_quote
     - 慣習として
       帰無仮説を *$H_0$*, 
       対立仮説を *$H_1$* で表す
     - 「帰無仮説を捨てて無に帰する」ことを期待する場合が多い

** 帰無仮説と対立仮説
   - 例: 薬の治験 (単純な場合)
     - 帰無仮説 $H_0$: 新しい薬も古い薬も効能は同じ
     - 対立仮説 $H_1$: 新しい薬と古い薬の効能は異なる
   - 例: 薬の治験 (新薬がより良いことを期待する場合)
     - 帰無仮説 $H_0$: 新しい薬も古い薬も効能は同じ
     - 対立仮説 $H_1$: 新しい薬の方が古い薬より効能が高い

** 検定の準備
   - 帰無分布
     #+begin_quote
     帰無仮説が正しい場合に検定統計量が従う分布
     #+end_quote
   - 棄却域
     #+begin_quote
     帰無仮説の下で統計量の取り得るべき範囲の外の領域
     #+end_quote
   - 仮説検定
     - 帰無仮説を *棄却*: 帰無仮説は誤っていると判断すること
     - 帰無仮説を *受容*: 帰無仮説を積極的に棄却できないこと
   - 検定の誤り
     - *第一種過誤*: 「正しい帰無仮説を棄却する」誤り
     - *第二種過誤*: 「誤った帰無仮説を受容する」誤り

** 検定の設計指針
   - 検定統計量 $T$ に対して棄却域 $R$ を設計
     - *サイズ*: 第一種過誤が *起きる確率*
       #+begin_src latex
         \begin{equation}
           \text{(サイズ)}
           =P(\text{$T$ が$R$に含まれる}|\text{帰無仮説が正しい})
         \end{equation}
       #+end_src
     - *検出力*: 第二種過誤が *起きない確率*
       #+begin_src latex
         \begin{equation}
           \text{(検出力)}
           =P(\text{$T$ が$R$に含まれる}|\text{対立仮説が正しい})
         \end{equation}
       #+end_src
   - *有意水準*
     #+begin_quote
     第一種過誤が起きる確率(サイズ)として許容する上限
     #+end_quote

** 棄却域の決め方
   - 検定を構成する場合の一般的な戦略: \\
     棄却域 $R_{\alpha}$ は以下のように設定する
     - *サイズを小さく* (有意水準 $\alpha$ 以下に) 抑える
     - 可能な限り *検出力を大きく* する
       #+begin_src latex
         \begin{align}
           P(T \in R_{\alpha}|\text{帰無仮説が正しい})
             &\le\alpha\\
           P(T \in R_{\alpha}|\text{対立仮説が正しい})
             &\to\text{最大化}
         \end{align}
       #+end_src
   - 対立仮説によって棄却域の形は変わり得る

** $p$ 値 (有意確率)
   - 帰無分布における検定統計量の評価:
     #+begin_quote
     検定統計量の値が棄却域に含まれる有意水準の最小値を考える
     #+end_quote
   - *$p$ 値 (有意確率)*: (検定統計量 $T$, 棄却域 $R_{\alpha}$)
     #+begin_src latex
       \begin{equation}
         \text{($p$ 値)}
         =\min\{\alpha\in(0,1)|\text{$T$ が$R_{\alpha}$に含まれる}\}
       \end{equation}
     #+end_src
   - $p$ 値が有意水準未満のときに帰無仮説を棄却する

** 検定に関する注意
   - 帰無仮説の受容の意味:
     #+begin_quote
     帰無仮説が正しいと仮定しても矛盾は生じない
     
     帰無仮説の正しさを積極的に支持する結果ではない
     #+end_quote
   - 第二種過誤:
     #+begin_quote
     一般に第二種過誤の起こる確率については何ら仮定がないため，
     その確率は非常に大きい可能性がある
     #+end_quote

* 正規母集団に対する　検定 (1標本)　
** 1標本データに対する仮定
   - 観測データは独立同分布な確率変数列
     $X_1,X_2,\dotsc,X_n$
   - $X_{i}$ は平均 $\mu$, 分散 $\sigma^2$ の正規分布に従う
   - 以下では $\mu$ および分散 $\sigma^2$ に対する検定を説明

* 平均の検定
** 平均の検定  (両側検定)
   - $\mu_0$ を既知の定数として，
     平均 $\mu$ が真の平均 $\mu_0$ であるか否かを検定する
     - 帰無仮説: $\mu=\mu_0$
     - 対立仮説: $\mu\neq\mu_0$
       \begin{equation}
	 H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu\neq\mu_0.
       \end{equation}

** 考え方
   - 標本平均 $\bar{X}$ が
     真の平均 $\mu_0$ とどの程度離れているかを検証する
     - 標本平均: (正規分布に従う)
       \begin{equation}
         \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
       \end{equation}
     - 不偏分散: ($\chi^2$ 分布に従う)
       \begin{equation}
         s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2
       \end{equation}
     の性質を用いて検定統計量を構成する

** 考え方 (つづき)
   - 検定統計量: 
     \begin{equation}
       t=\frac{\sqrt{n}(\bar{X}-\mu_0)}{s}
     \end{equation}
   - 帰無仮説 $H_0$ が正しいならば $t$ は自由度 $n{-}1$ の $t$ 分布に従う
   - 帰無分布が $t$ 分布となるので *Studentの $t$ 検定* と呼ばれる
  
** 棄却域の取り方
   - 有意水準: $\alpha\in(0,1)$
   - 自由度 $n{-}1$ の $t$ 分布の
     $1{-}\alpha/2$ 分位点: $t_{1{-}\alpha/2}(n{-}1)$ 
   - $H_0$ の下で以下が成立:
     \begin{equation}
       P(|t|>t_{1{-}\alpha/2}(n{-}1))=\alpha
     \end{equation}
   - 第一種過誤の上限が $\alpha$ の棄却域:
     \begin{equation}
       R_{\alpha}=
       \left(-\infty,-t_{1{-}\alpha/2}(n{-}1)\right)
       \cup\left(t_{1{-}\alpha/2}(n{-}1),\infty\right)
     \end{equation}

** 検定の手順 (棄却域を用いる場合)
   - データから検定統計量 $t$ の値を計算
   - 以下の場合，帰無仮説を棄却:
     \begin{equation}
       |t|>t_{1{-}\alpha/2}(n{-}1)
     \end{equation}

** 検定の手順 ($p$ 値を用いる場合)
   - $p$ 値を計算: ( $f(x)$:自由度 $n{-}1$ の $t$ 分布の密度)
     \begin{equation}
       \text{($p$ 値)}
       =2\int_{|t|}^\infty f(x)dx
     \end{equation}
   - $p$ 値が $\alpha$ 未満なら帰無仮説を棄却:
     \begin{align}
       |t|>t_{1{-}\alpha/2}(n{-}1)
       &\Leftrightarrow
	 \int_{-\infty}^{|t|}f(x)dx>1{-}\alpha/2\\
       &\Leftrightarrow
	 2\int_{|t|}^\infty f(x)dx < \alpha
     \end{align}
     # (棄却域に入ることと $p$ 値が有意水準未満となることは同義)

** 対立仮説の違い
   - 例: 薬の治験 \\
     観測データ $X_1,X_2,\dotsc,X_n$ ($n$ 人の被験者の治験結果)
     に対する仮説:
     - 古い薬(高価)と新しい薬(安価)の効能が変わらない 
     - 古い薬に比べて新しい薬の効能が改善した
   - 対立仮説の立て方によって棄却域の形は変わりうる

** 平均の検定 (片側検定)
   - $\mu_0$ を既知の定数として，
     平均 $\mu$ が真の平均 $\mu_0$ より大きいかを検定する
     - 帰無仮説: $\mu=\mu_0$
     - 対立仮説: $\mu>\mu_0$
     \begin{equation}
       H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu>\mu_0.
     \end{equation}
   - 検定統計量の標本分布:
     - 帰無仮説は同一なので検定統計量 $t$ の帰無分布も同一となる
     - 対立仮説の下で $t$ の値が正の方向に大きくなると期待される
   - 棄却域 "$t>c$" ($c$ は正の数) を考えるのが自然

** 棄却域の取り方
   - 有意水準: $\alpha\in(0,1)$
   - 自由度 $n{-}1$ の $t$ 分布の $1{-}\alpha$ 分位点:
     $t_{1{-}\alpha}(n{-}1)$
   - $H_0$ の下で以下が成立:
     \begin{equation}
       P(t>t_{1{-}\alpha}(n{-}1))=\alpha
     \end{equation}
   - 第一種過誤の上限が $\alpha$ の棄却域:
     \begin{equation}
       R_{\alpha}=
       \left(t_{1{-}\alpha}(n{-}1),\infty\right)
     \end{equation}

** 検定の手順 (棄却域を用いる場合)
   - データから検定統計量 $t$ の値を計算
   - 以下の場合，帰無仮説を棄却:
     \begin{equation}
       t>t_{1{-}\alpha}(n{-}1)
     \end{equation}

** 検定の手順 ($p$ 値を用いる場合)
   - $p$ 値を計算: ( $f(x)$:自由度 $n{-}1$ の $t$ 分布の密度)
     \begin{equation}
       \text{($p$ 値)}=
       \int_{t}^\infty f(x)dx
     \end{equation}
   - $p$ 値が $\alpha$ 未満なら帰無仮説を棄却

** 両側検定と片側検定
   - *右片側検定*: 棄却域がある定数 $a$ によって $(a,\infty)$
   - *左片側検定*: 棄却域がある定数 $a$ によって $(-\infty,a)$
     - 右片側検定と左片側検定を合わせて *片側検定* と呼ぶ
   - *両側検定*: 棄却域がある定数 $a < b$ によって $(-\infty,a)\cup(b,\infty)$
   - 平均の検定の場合:
     - 対立仮説を $H_1:\mu\neq\mu_0$ にとった場合は両側検定
     - 対立仮説を $H_1:\mu>\mu_0$ にとった場合は右片側検定

** 平均の検定 (片側検定)
   - 反対向きの対立仮説 $\mu < \mu_0$ を考えた検定
     \begin{equation}
       H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu < \mu_0.
     \end{equation}
   - 自由度 $n{-}1$ の $t$ 分布の $\alpha$ 分位点:
     $t_{\alpha}(n{-}1)$
   - 以下の場合，帰無仮説を棄却 (左片側検定):
     \begin{equation}
       t < t_{\alpha}(n{-}1)
     \end{equation}
   - 以下の $p$ 値が $\alpha$ 未満なら帰無仮説を棄却:
     \begin{equation}
       \text{($p$ 値)}
       =\int_{-\infty}^t f(x)dx
     \end{equation}

** 演習
   :PROPERTIES:
   :reveal_background: #fef4f4
   :END:
   - ~test-mean.r~ を確認しなさい．
   - ~test-region.r~ を確認しなさい．
   - 自身で収集したデータについて，
     平均値に関する検定を行いなさい．

* 分散の検定
** 分散の検定 (両側検定)
   - $\sigma_0^2$ を既知の定数として，
     分散 $\sigma^2$ が $\sigma_0^2$ であるか否かを検定する
     - 帰無仮説: $\sigma^2=\sigma_0^2$
     - 対立仮説: $\sigma^2\neq\sigma_0^2$
     \begin{equation}%\label{two-side}
       H_0:\sigma^2=\sigma_0^2\quad\text{vs}\quad H_1:\sigma^2\neq\sigma_0^2
     \end{equation}

** 考え方
   - 不偏分散 $s^2$ が
     真の分散 $\sigma_{0}^{2}$ とどの程度離れているかを検証する
     - 不偏分散: ($\chi^2$ 分布に従う)
       \begin{equation}
        s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2 
       \end{equation}
     の性質を用いて検定統計量を構成する

** 考え方 (つづき)
   - 検定統計量:
     \begin{equation}
       \chi^2=(n{-}1)s^2/\sigma_0^2
     \end{equation}
   - 帰無仮説 $H_0$ が正しいならば $\chi^2$ は自由度 $n{-}1$ の $\chi^2$ 分布に従う
   - 帰無分布が $\chi^2$ 分布となるので *$\chi^2$ 検定* と呼ばれる

** 棄却域の取り方
   - 有意水準: $\alpha\in(0,1)$
   - 自由度 $n{-}1$ の $\chi^2$ 分布の
     $\alpha/2$ 分位点:
     $\chi^2_{\alpha/2}(n{-}1)$
   - 自由度 $n{-}1$ の $\chi^2$ 分布の
     $1{-}\alpha/2$ 分位点:
     $\chi^2_{1{-}\alpha/2}(n{-}1)$
   - $H_0$ の下で以下が成立:
     \begin{equation}
       P(\chi^2 < \chi^2_{\alpha/2}(n{-}1)
       \text{ または }\chi^2>\chi^2_{1{-}\alpha/2}(n{-}1))
       =\alpha
     \end{equation}
   - 第一種過誤の上限が $\alpha$ となる棄却域:
     \begin{equation}
       R_{\alpha}=
       \left(-\infty,\chi^2_{\alpha/2}(n{-}1)\right)
       \cup\left(\chi^2_{1{-}\alpha/2}(n{-}1),\infty\right)
     \end{equation}

** 検定の手順 (棄却域を用いる場合)
   - データから検定統計量 $\chi^2$ の値を計算
   - 以下の場合，帰無仮説を棄却:
     \begin{equation}
       \chi^2 < \chi^2_{\alpha/2}(n{-}1)
       \text{ または }\chi^2>\chi^2_{1{-}\alpha/2}(n{-}1)
     \end{equation}

** 検定の手順 ($p$ 値を用いる場合)
   - $p$ 値を計算: ( $f(x)$:自由度 $n{-}1$ の $\chi^2$ 分布の密度)
     \begin{equation}
       \text{($p$ 値)}
       =2\min\left\{\int_0^{\chi^2}f(x)dx,\int_{\chi^2}^\infty f(x)dx\right\}
     \end{equation}
   - $p$ 値が $\alpha$ 未満なら帰無仮説を棄却

** 分散の検定 (片側検定)
   - 対立仮説が片側 (右側対立仮説) の場合:
     - 帰無仮説: $\sigma^2=\sigma_0^2$
     - 対立仮説: $\sigma^2>\sigma_0^2$
     \begin{equation}%\label{two-side}
       H_0:\sigma^2=\sigma_0^2\quad
       \text{vs}\quad H_1:\sigma^2>\sigma_0^2
     \end{equation}
   - 左側対立仮説 $H_1:\sigma^2 < \sigma_0^2$ の場合も以下の議論は同様

  
** 検定の手順 (棄却域を用いる場合)
   - 自由度 $n{-}1$ の $\chi^2$ 分布の $1{-}\alpha$ 分位点:
     $\chi^2_{1{-}\alpha}(n{-}1)$
   - 以下の場合，帰無仮説を棄却:
     \begin{equation}
       \chi^2>\chi^2_{1{-}\alpha}(n{-}1)
     \end{equation}
** 検定の手順 ($p$ 値を用いる場合)
   - $p$ 値を計算: ( $f(x)$:自由度 $n{-}1$ の $\chi^2$ 分布の密度)
     \begin{equation}
       \text{($p$ 値)}
       =\int_{\chi^2}^\infty f(x)dx
     \end{equation}
   - $p$ 値が $\alpha$ 未満なら帰無仮説を棄却

** 演習 (分散の検定)
   :PROPERTIES:
   :reveal_background: #fef4f4
   :END:
   - ~test-var.r~ を確認しなさい．
   - 自身で収集したデータについて，
     分散に関する検定を行いなさい．

* 正規母集団に対する　検定 (2標本)　
** 2標本データに対する仮定
   - 2種類の観測データ:
     - $X_1,X_2,\dotsc,X_m$
     - $Y_1,Y_2,\dotsc,Y_n$
   - 3つの条件を仮定:
     - $X_1,X_2,\dotsc,X_m,Y_1,Y_2,\dotsc,Y_n$ は
       独立な確率変数列
     - $X_1,\dotsc,X_m$ は同分布で，
       平均 $\mu_1$, 分散 $\sigma_1^2$ の正規分布に従う
     - $Y_1,\dotsc,Y_n$ は同分布で，
       平均 $\mu_2$, 分散 $\sigma_2^2$ の正規分布に従う
   - 両者の平均や分散が一致するかどうかを検定する問題を考える

* 平均の差の検定
** 平均の差の検定
   - 2種類のデータの平均が等しいか否かを検定する
     \begin{equation}%\label{mean-equal}
       H_0:\mu_1=\mu_2\quad\text{vs}\quad H_1:\mu_1\neq\mu_2
     \end{equation}
   - *Behrens-Fisher問題* として知られている
   - 正確かつ適切な検定を導出することは難しい
   - *Welch(またはSatterthwaite)の近似法*:
     - $\chi^2$ 分布に従う独立確率変数列の一次結合の分布を，
       1つの $\chi^2$ 分布に従う確率変数の定数倍の分布で近似する方法
     - 平均と分散が元の確率変数と一致するように近似

** 考え方
   - $X_1,\dotsc,X_m$ および $Y_1,\dotsc,Y_m$ の不偏分散:
     $s_1^2$,$s_2^2$
     \begin{equation}
       s_1^2=\frac{1}{m{-}1}\sum_{i=1}^m(X_i-\bar{X})^2,\quad
       s_2^2=\frac{1}{n{-}1}\sum_{i=1}^n(Y_i-\bar{Y})^2.
     \end{equation}
   - 標本平均と不偏分散の性質:
     - $\bar{X}-\bar{Y},s_1^2,s_2^2$ は独立となる
     - $(m{-}1)s_1^2/\sigma_1^2$
       は自由度 $m{-}1$ の $\chi^2$ 分布に従う 
     - $(n{-}1)s_2^2/\sigma_2^2$
       は自由度 $n{-}1$ の $\chi^2$ 分布に従う 

** Welchの近似法 
   - *詳細は資料を参照*
   - 確率変数 $s_1^2/m+s_2^2/n$ の分布を $c\chi^2_\nu$ の分布で近似
   - $\chi^2_\nu$ は自由度 $\nu$ の $\chi^2$ 分布に従う確率変数
     \begin{equation}
       c=\frac{\frac{(\sigma_1^2/m)^2}{m{-}1}
	 +\frac{(\sigma_2^2/n)^2}{n{-}1}}{\sigma_1^2/m+\sigma_2^2/n},\quad
       \nu=\frac{(\sigma_1^2/m+\sigma_2^2/n)^2}{\frac{(\sigma_1^2/m)^2}{m{-}1}
	 +\frac{(\sigma_2^2/n)^2}{n{-}1}}
     \end{equation}
     (平均と分散を合わせる)

** Welchの近似法 (つづき)
   - 検定統計量:
     \begin{equation}
       t=\frac{\bar{X}-\bar{Y}}{\sqrt{s_1^2/m+s_2^2/n}}
       \simeq\frac{\bar{X}-\bar{Y}}{\sqrt{c\chi^2_\nu}}
     \end{equation}
   - $\bar{X}-\bar{Y},s_1^2/m+s_2^2/n$ は独立
   - $\bar{X}-\bar{Y},c\chi^2_\nu$ も独立とすべき
   - $t$ の分布は $(\bar{X}-\bar{Y})/\sqrt{c\chi^2_\nu}$ で近似できる

** 帰無分布の近似
   - データの正規性から以下は標準正規分布に従う
     \begin{equation}
       \frac{(\bar{X}-\bar{Y})-(\mu_1{-}\mu_2)}
       {\sqrt{\sigma_1^2/m+\sigma_2^2/n}}
     \end{equation}
   - $H_0$ の下で以下は自由度 $\nu$ の $t$ 分布に従う
     \begin{equation}
       t\simeq
       \frac{\bar{X}-\bar{Y}}{\sqrt{c\chi^2_\nu}}
       \left(=\frac{(\bar{X}-\bar{Y})/\sqrt{\sigma_1^2/m+\sigma_2^2/n}}
	 {\sqrt{\frac{c}{\sigma_1^2/m+\sigma_2^2/n}\chi^2_\nu}}\right)
     \end{equation}
     # ($\frac{c}{\sigma_1^2/m+\sigma_2^2/n}=\nu^{-1}$に注意)

** 帰無分布の近似 (つづき)
   - 検定統計量 $t$ の帰無分布は自由度 $\nu$ の $t$ 分布で近似できる
   - $\nu$ は未知の分散 $\sigma_1^2,\sigma_2^2$ を含むので
     不偏推定量 $s_1^2,s_2^2$ で代用して, 
     次式で与えられる自由度 $\hat{\nu}$ を用いる:
     \begin{equation}
       \hat{\nu}
       =\frac{(s_1^2/m+s_2^2/n)^2}
       {\frac{(s_1^2/m)^2}{m{-}1}+\frac{(s_2^2/n)^2}{n{-}1}}.
     \end{equation}
   - この検定の考え方は *Welchの $t$ 検定* と呼ばれる

** 検定の手順 (棄却域を用いる場合)
   - 有意水準: $\alpha\in(0,1)$
   - 自由度 $\hat{\nu}$ の $t$ 分布の $1{-}\alpha/2$ 分位点:
     $t_{1{-}\alpha/2}(\hat{\nu})$
   - 棄却域:
     \begin{equation}
       \left(-\infty,-t_{1{-}\alpha/2}(\hat{\nu})\right)
       \cup\left(t_{1{-}\alpha/2}(\hat{\nu}),\infty\right)
     \end{equation}
   - 検定統計量 $t$ の値を計算し，以下の場合，帰無仮説を棄却:
     \begin{equation}
       |t|>t_{1{-}\alpha/2}(\hat{\nu})
     \end{equation}
   - $p$ 値の計算や片側対立仮説への対応方法は前と同様

** 平均の差の検定 (対応がある場合)
   - 対応がある観測データの平均の差の検定では
     2種類のデータ間の自然な対応を考慮することがある
   - 例: 
     - 2種類の薬の効能を比較するために被験者に両方の薬を投与
     - 被験者 $i$ にそれぞれの薬を投与した場合の治験結果: $X_i,Y_i$
     - $X_i$ と $Y_i$ には「同一の被験者に対する治験結果」という意味で対応がある
   - 「対応がある観測値の差の平均が0」という検定を考える
   - $Z_i=X_i-Y_i$ $(i=1,\dotsc,n)$ として，
     $Z_1,\dotsc,Z_n$ の平均が0か否かを検定すれば良い

** 演習
   :PROPERTIES:
   :reveal_background: #fef4f4
   :END:
   - ~test-diff.r~ を確認しなさい．
   - ~test-welch.r~ を確認しなさい．
   - ~test-paired.r~ を確認しなさい．
   - 自身で収集したデータについて，
     2標本の平均値の差に関する検定を行いなさい．

* 分散の比の検定
** 分散の比の検定
   - 2種類のデータの分散が等しいか否かを検定する
     \begin{equation}%\label{mean-equal}
       H_0:\sigma_1^2=\sigma_2^2\quad\text{vs}\quad H_1:\sigma_1^2\neq\sigma_2^2
     \end{equation}

** 考え方
   - $X_1,\dotsc,X_m$ の不偏分散: $s_1^2$
   - $Y_1,\dotsc,Y_n$ の不偏分散: $s_2^2$
   - このとき $s_1^2,s_2^2$ は独立でそれぞれ
     - $(m{-}1)s_1^2/\sigma_1^2$
       自由度 $m{-}1$ の $\chi^2$ 分布に従う
     - $(n{-}1)s_2^2/\sigma_2^2$
       は自由度 $n{-}1$ の $\chi^2$ 分布に従う
   - 検定統計量:
     \begin{equation}
       F=s_1^2/s_2^2
     \end{equation}
   - 帰無仮説 $H_0$ が正しいならば
     $F$ は自由度 $m{-}1,n{-}1$ の $F$ 分布に従う
  
** 棄却域の取り方
   - 有意水準: $\alpha\in(0,1)$
   - 自由度 $m{-}1,n{-}1$ の $F$ 分布の
     $\alpha/2,\,1{-}\alpha/2$ 分位点:
     $F_{\alpha/2}(m{-}1,n{-}1)$,
     $F_{1{-}\alpha/2}(m{-}1,n{-}1)$
   - $H_0$ の下では以下が成立:
     \begin{equation}
       P(F < F_{\alpha/2}(m{-}1,n{-}1)
       \text{ または }F > F_{1{-}\alpha/2}(m{-}1,n{-}1))=\alpha
     \end{equation}
   - 第一種過誤の上限が $\alpha$ の棄却域:
     \begin{equation}
       R_{\alpha}=
       \left(-\infty,F_{\alpha/2}(m{-}1,n{-}1)\right)
       \cup\left(F_{1{-}\alpha/2}(m{-}1,n{-}1),\infty\right)
     \end{equation}

** 検定の手順 (棄却域を用いる場合)
   - データから検定統計量 $F$ の値を計算
   - 以下の場合，帰無仮説を棄却
     \begin{equation}
       F < F_{\alpha/2}(m{-}1,n{-}1)
       \text{ または }F>F_{1{-}\alpha/2}(m{-}1,n{-}1)
     \end{equation}
   - $p$ 値の計算や片側対立仮説への対応方法は前と同様

** 演習
   :PROPERTIES:
   :reveal_background: #fef4f4
   :END:
   - ~test-ratio.r~ を確認しなさい．
   - 自身で収集したデータについて，
     2標本の分散の比に関する検定を行いなさい．
