<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>確率分布</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/css/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/lib/font/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./myconf.css"/>
<link rel="stylesheet" href="./reveal.js/lib/css/zenburn.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = './reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">確率分布</h1>
</div>
<div class="talk-subtitle">
    <p>いろいろな離散分布と連続分布</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  2020.06.05</p>
</div>

</section>

<section>
<section id="slide-org1aeecf3">
<h2 id="org1aeecf3">一般の確率変数</h2>
<div class="outline-text-2" id="text-org1aeecf3">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge44fdc5">
<h3 id="orge44fdc5">確率分布</h3>
<ul>
<li>確率変数 \(X\) : 
<ul>
<li>値がランダムに決定される変数</li>
<li>任意の区間 \([a,b]\) に含まれる確率が定められている</li>

</ul></li>
<li>確率分布 \(P\) (または単に分布):
<ul>
<li><p>
区間 \([a,b]\) \((a\leq b)\) に \(X\) が含まれる確率
</p>
<div>
\begin{equation}
  P(a\leq X\leq b)
\end{equation}

</div></li>

<li>「確率変数 \(X\) は確率分布 \(P\) に従う」という</li>
<li>現象の理解のためには実現値より確率分布にこそ興味がある</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgac032f8">
<h3 id="orgac032f8">極限定理</h3>
<ul>
<li>大数の法則，
中心極限定理，
少数の法則など</li>
<li>緩やかな条件のもとで一般の確率変数の列についても成立する
<ul>
<li>大数の強法則は平均が存在すれば成立する <br />
(平均と分散は後に定義する)</li>
<li>2次のモーメントをもたない(計算できない)場合には
中心極限定理は成立しない <br />
(そもそも分散が定義できない)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3b9e695">
<h3 id="org3b9e695">確率変数列の独立性</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
\(n\) 個の確率変数 \(X_{1},X_{2},\dotsc,X_n\) が <b>独立</b> であるとは，
\(a_i\leq b_i\) \((i=1,\dots,n)\) なる
任意の実数 \(a_{1},b_{1},\dots,a_n,b_n\) に対して
</p>
<div>
\begin{multline}
  P(a_{1}\leq X_{1}\leq b_{1},a_{2}\leq X_{2}\leq b_{2},\dots,a_n\leq X_n\leq b_n)\\
  =P(a_{1}\leq X_{1}\leq b_{1})P(a_{2}\leq X_{2}\leq b_{2})\cdots P(a_n\leq X_n\leq b_n)
\end{multline}

</div>

<p>
が成り立つことをいう．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org6768d05">
<h3 id="org6768d05">確率変数列の同分布性</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
\(n\) 個の確率変数 \(X_{1},X_{2},\dotsc,X_n\) が <b>同分布</b> であるとは，
\(a\leq b\) なる任意の実数 \(a,b\) に対して
</p>
<div>
\begin{equation}
  P(a\leq X_{1}\leq b)=P(a\leq X_{2}\leq b)=\cdots=P(a\leq X_n\leq b)
\end{equation}

</div>

<p>
が成り立つことをいう．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgdca5f02">
<h2 id="orgdca5f02">離散分布</h2>
<div class="outline-text-2" id="text-orgdca5f02">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org6920e33">
<h3 id="org6920e33">離散分布</h3>
<ul>
<li>離散型確率変数:
<ul>
<li>取りうる値が有限個 <br />
もしくは可算無限個 (例えば整数値のみとる場合)</li>

</ul></li>
<li>離散分布:
<ul>
<li>離散型確率変数の確率分布</li>
<li>\(X=x\) となる確率 \(P(X=x)\) で完全に決定される</li>
<li>関数 \(f(x)=P(X=x)\) を 
<b>確率関数</b> (<b>確率質量関数</b>) 
と呼ぶ</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgd2490e9">
<h3 id="orgd2490e9">離散分布の平均</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
以下の右辺が定義できる(絶対収束する)とき
離散型の確率変数 
\(X\) の <b>平均</b> (または <b>期待値</b> )を
</p>
<div>
\begin{equation}
  \mathbb{E}[X]:=\sum_{x\in\mathcal{X}}xP(X=x)
\end{equation}

</div>

<p>
で定義する．
</p>

<p>
ただし 
\(\mathcal{X}\) は \(X\) の取りうる値(無限個も可)の集合
</p>
</blockquote>
<ul>
<li>級数 \(\sum_{x\in\mathcal{X}}xP(X=x)\) が
定義できない場合は
\(X\) は平均をもたない</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
確率変数の変換 \(\varphi(X)\) の期待値:
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[\varphi(X)]:=\sum_{x\in\mathcal{X}}\varphi(x)P(X=x)
\end{equation}

</div>
</blockquote></li>
<li><p>
\(p\) 次の <b>モーメント</b> (あるいは <b>積率</b> ):
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[X^p]=\sum_{x\in\mathcal{X}}x^pP(X=x)
\end{equation}

</div>
</blockquote>
<ul>
<li>\(X\) が正整数 \(p\) 次のモーメントをもてば，
\(q\leq p\) なるすべての正整数 \(q\) 次のモーメントをもつ</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org113d849">
<h3 id="org113d849">離散分布の分散</h3>
<ul>
<li><p>
<b>分散</b> :
</p>
<div>
\begin{align}
  \mathrm{Var}(X)
  :=&\mathbb{E}[(X-\mathbb{E}[X])^2]\\
  =&\sum_{x\in\mathcal{X}}(x-\mathbb{E}[X])^2P(X=x)
\end{align}

</div></li>

<li><b>注:</b> \(X\) が2次のモーメントをもつときのみ定義できる</li>
<li>分散の平方根\(\sqrt{\mathrm{Var}(X)}\) を <b>標準偏差</b> と呼ぶ</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgd741177">
<h2 id="orgd741177">離散一様分布</h2>
<div class="outline-text-2" id="text-orgd741177">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc541fcd">
<h3 id="orgc541fcd">離散一様分布の確率関数</h3>
<ul>
<li>集合 \(\{x_{1},\dots,x_n\}\) 上の離散一様分布: <br />
\(x_{1},\dots,x_n\) は相異なる実数を箱(壺)から取り出す試行</li>
<li><p>
確率関数: 
</p>
<div>
\begin{equation}
  f(x)=\frac{1}{n},\quad
  x\in\{x_{1},\dots,x_n\}
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org30af49c">
<h3 id="org30af49c">離散一様分布の平均と分散</h3>
<ul>
<li><p>
平均:
</p>
<div>
\begin{equation}
  \mathbb{E}[X]
  =\sum_{i=1}^nx_if(x_i)
  =\frac{1}{n}\sum_{i=1}^nx_i=\bar{x}
\end{equation}

</div></li>

<li><p>
分散:
</p>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\sum_{i=1}^n(x_i-\mathbb{E}[X])^2f(x_i)
  =\frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^2
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgeb7c357">
<h3 id="orgeb7c357">実行例: <code>dist-dunif.r</code></h3>
<ul>
<li>歪みのないサイコロを1回投げたときに出る目の分布は, 
集合 \(\{1,\dots,6\}\) 上の離散一様分布に従う</li>
<li>離散一様分布に従う乱数の発生は
<code>sample()</code> が利用できる( <code>replace=TRUE</code>; 復元抽出)</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org7dc323a">
<h2 id="org7dc323a">二項分布</h2>
<div class="outline-text-2" id="text-org7dc323a">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org9fb2853">
<h3 id="org9fb2853">二項分布の確率関数</h3>
<ul>
<li>試行回数 \(n\) , 成功確率 \(p\) の二項分布: <br />
確率 \(p\) で成功する試行を \(n\) 回行った総成功回数</li>
<li><p>
確率関数:
</p>
<div>
\begin{equation}
  f(x)=\Bigl({n\atop x}\Bigr)p^x(1-p)^{n-x},\quad x=0,1,\dots,n
\end{equation}

</div></li>

<li>平均は \(np\) , 分散は \(np(1-p)\) で与えられる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2641cdd">
<h3 id="org2641cdd">二項分布の平均と分散</h3>
<ul>
<li><p>
平均:
</p>
<div>
\begin{align}
  \mathbb{E}[X]
  &=\sum_{x=0}^nxf(x)=\sum_{x=0}^nx\Bigl({n\atop x}\Bigr)p^x(1-p)^{n-x}\\
  &=\sum_{x=1}^n\frac{n!}{(x-1)!(n-x)!}p^x(1-p)^{n-x}\\
  % &=\sum_{x=0}^{n-1}\frac{n!}{x!(n-x-1)!}p^{x+1}(1-p)^{n-x-1}\\
  &=np\sum_{x=0}^{n-1}\Bigl({n-1\atop x}\Bigr)p^{x}(1-p)^{n-1-x}\\
  &=np
\end{align}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3138501">
<h3 id="org3138501">二項分布の平均と分散</h3>
<ul>
<li><p>
2次モーメント:
</p>
<div>
\begin{align}
  \mathbb{E}[X^2]
  &=\sum_{x=0}^nx^2f(x)
   =\sum_{x=0}^nx(x-1)\Bigl({n\atop x}\Bigr)p^x(1-p)^{n-x}+\mathbb{E}[X]\\
  % &=\sum_{x=2}^n\frac{n!}{(x-2)!(n-x)!}p^x(1-p)^{n-x}+np\\
  % &=\sum_{x=0}^{n-2}\frac{n!}{x!(n-x-2)!}p^{x+2}(1-p)^{n-x-2}+np\\
  &=n(n-1)p^2\sum_{x=0}^{n-2}\Bigl({n-2\atop x}\Bigr)p^{x}(1-p)^{n-2-x}+np\\
  &=n(n-1)p^2+np
    =(np)^2+np(1-p)
\end{align}

</div></li>

<li><p>
分散: 
</p>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\mathbb{E}[X^2]-\mathbb{E}[X]^2
  =np(1-p)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org02e9421">
<h3 id="org02e9421">実行例 : <code>dist-binom.r</code></h3>
<ul>
<li>表が出る確率が \(p\) のコインを \(n\) 回投げたときに表が出る回数は，
試行回数 \(n\) ，成功確率 \(p\) の二項分布に従う</li>
<li>二項分布に従う乱数の発生は <code>rbinom()</code> を用いる</li>
<li>二項分布の確率関数は <code>dbinom()</code> で計算できる</li>
<li>試行回数1の二項分布を <b>Bernoulli分布</b> と呼ぶ</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2daae62" data-background="#fef4f4">
<h3 id="org2daae62">演習</h3>
<ul>
<li>二項分布の平均と分散の計算を確認しなさい．</li>
<li>\(X_{1},\dotsc,X_n\) を成功確率 \(p\) の
Bernoulli分布に従う独立同分布な確率変数列とする．
このとき \(\sum_{i=1}^nX_i\) の分布は，
試行回数 \(n\) , 成功確率 \(p\) の二項分布に従う．
これを実行例を参考にしてグラフに描画して確認しなさい．</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgfeba256">
<h2 id="orgfeba256">Poisson分布</h2>
<div class="outline-text-2" id="text-orgfeba256">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org4a90db6">
<h3 id="org4a90db6">Poisson分布の確率関数</h3>
<ul>
<li>強度 \(\lambda\) のPoisson分布: \(P_o(\lambda)\) (\(\lambda > 0\))<br />
少数の法則に現れた滅多に起こらない事象の起こる回数の分布</li>
<li><p>
確率関数:
</p>
<div>
\begin{equation}
  f(x)=\frac{\lambda^x}{x!}e^{-\lambda},\quad x=0,1,\dotsc
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge974881">
<h3 id="orge974881">Poisson分布の平均</h3>
<ul>
<li><p>
平均:
</p>
<div>
\begin{align}
  \mathbb{E}[X]
  &=\sum_{x=0}^\infty xf(x)=\sum_{x=0}^\infty x\frac{\lambda^x}{x!}e^{-\lambda}
    =e^{-\lambda}\sum_{x=1}^\infty\frac{\lambda^x}{(x-1)!}\\
  &=\lambda e^{-\lambda}\sum_{x=0}^\infty\frac{\lambda^x}{x!}
    =\lambda
\end{align}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3e75a36">
<h3 id="org3e75a36">Poisson分布の分散</h3>
<ul>
<li><p>
2次モーメント:
</p>
<div>
\begin{align}
  \mathbb{E}[X^2]
  &=\sum_{x=0}^\infty x^2f(x)
    =\sum_{x=0}^\infty x(x-1)\frac{\lambda^x}{x!}e^{-\lambda}+\mathbb{E}[X]\\
  &=e^{-\lambda}\sum_{x=2}^\infty\frac{\lambda^x}{(x-2)!}+\lambda
    =\lambda^2 e^{-\lambda}\sum_{x=0}^\infty\frac{\lambda^x}{x!}+\lambda\\
  &=\lambda^2+\lambda
\end{align}

</div></li>

<li><p>
分散: 
</p>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\mathbb{E}[X^2]-\mathbb{E}[X]^2=\lambda
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgba261b0">
<h3 id="orgba261b0">実行例: <code>dist-pois.r</code></h3>
<ul>
<li>放射性物質から一定時間に放射される粒子の数や，
一定期間に起こる交通事故の数などはPoisson分布に従うことが知られている</li>
<li>発生確率が低い事象が十分長い期間で起こる回数の分布は
Poisson分布で近似できる (少数の法則)</li>
<li>Poisson分布に従う乱数の発生は <code>rpois()</code> を用いる</li>
<li>Poisson分布の確率関数は <code>dpois()</code> で計算できる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org1cd2123" data-background="#fef4f4">
<h3 id="org1cd2123">演習</h3>
<ul>
<li>Poisson分布の平均と分散の計算を確認しなさい．</li>
<li>\(X,Y\) を独立な2つの確率変数とし，
それぞれ強度 \(\lambda_{1},\lambda_{2}\) のPoisson分布に従うとする．
このとき, 和 \(X+Y\) の分布は
強度 \(\lambda_{1}+\lambda_{2}\) のPoisson分布に従う．
これを実行例を参考にしながらグラフに描画して確認しなさい．</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org10d2c73">
<h2 id="org10d2c73">幾何分布</h2>
<div class="outline-text-2" id="text-org10d2c73">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc04e062">
<h3 id="orgc04e062">幾何分布の確率関数</h3>
<ul>
<li>成功確率 \(p\) の幾何分布: \((0 < p\leq 1)\) <br />
成功するまでの回数の分布</li>
<li><p>
確率関数:
</p>
<div>
\begin{equation}
  f(x)=p(1-p)^x,\quad x=0,1,\dots
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org35fa958">
<h3 id="org35fa958">幾何分布の平均</h3>
<ul>
<li><p>
平均: 
</p>
<div>
\begin{align}
  \mathbb{E}[X]
  &=\sum_{x=0}^\infty xf(x)=\sum_{x=0}^\infty xp(1-p)^x
   =p(1-p)\sum_{x=1}^\infty x(1-p)^{x-1}\\
  &=-p(1-p)\frac{d}{dp}\sum_{x=1}^\infty(1-p)^x
    =-p(1-p)\frac{d}{dp}\frac{1-p}{p}\\
  &=-p(1-p)\cdot\Bigl(-\frac{1}{p^2}\Bigr)
    =\frac{1-p}{p}
\end{align}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2336512">
<h3 id="org2336512">幾何分布の分散</h3>
<ul>
<li><p>
2次モーメント:
</p>
<div>
\begin{align}
  \mathbb{E}[X^2]
  &=\sum_{x=0}^\infty x^2f(x)=\sum_{x=0}^\infty x(x-1)p(1-p)^x+\mathbb{E}[X]\\
  % &=p(1-p)^2\sum_{x=2}^\infty x(x-1)p(1-p)^{x-2}+\frac{1-p}{p}\\
  % &=p(1-p)^2\frac{d^2}{dp^2}\sum_{x=2}^\infty (1-p)^{x}+\frac{1-p}{p}\\
  % &=p(1-p)^2\frac{d^2}{dp^2}\frac{(1-p)^2}{p}+\frac{1-p}{p}\\
  % &=p(1-p)^2\frac{2}{p^3}+\frac{1-p}{p}
  &=2\Bigl(\frac{1-p}{p}\Bigr)^2+\frac{1-p}{p}
\end{align}

</div></li>

<li><p>
分散: 
</p>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\mathbb{E}[X^2]-\mathbb{E}[X]^2
  =\frac{1-p}{p^2}
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgaecb629">
<h3 id="orgaecb629">実行例: <code>dist-geom.r</code></h3>
<ul>
<li>表が出る確率が \(p\) のコインを投げ続けて，
初めて表が出るまでに出た裏の回数は，
成功確率 \(p\) の幾何分布に従う</li>
<li>幾何分布に従う乱数の発生は <code>rgeom()</code> を用いる</li>
<li>幾何分布の確率関数は <code>dgeom()</code> で計算できる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgc79e4b1">
<h2 id="orgc79e4b1">連続分布</h2>
<div class="outline-text-2" id="text-orgc79e4b1">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org702f909">
<h3 id="org702f909">連続分布</h3>
<ul>
<li>連続型確率変数:
<ul>
<li>取りうる値が任意の実数またはある範囲の実数<br />
取りうる値のパターンが数多いため実数で近似</li>

</ul></li>
<li>連続分布:
<ul>
<li>連続型の確率変数の確率分布</li>
<li><p>
非負の値をとる実数上の関数 \(f\) の積分で表される
</p>
<div>
\begin{equation}
  P(a\leq X\leq b)=\int_{a}^b f(x)dx \quad(a < b)
\end{equation}

</div></li>

<li>関数 \(f\) を <b>確率密度関数</b> (または <b>密度</b>)と呼ぶ</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org129e5d7">
<h3 id="org129e5d7">連続分布の平均</h3>
<ul>
<li><p>
連続型の確率変数 \(X\) の平均: <br />
積分 \(\int_{-\infty}^\infty xf(x)dx\) が絶対収束するとき
\(X\) の <b>平均</b> (または <b>期待値</b>)を
</p>
<div>
\begin{equation}
  \mathbb{E}[X]:=\int_{-\infty}^\infty xf(x)dx
\end{equation}

</div>

<p>
で定義する
</p></li>
<li><b>注:</b> 積分 \(\int_{-\infty}^\infty xf(x)dx\) が
絶対収束しない場合は<br />
\(X\) は平均をもたない</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org471c9b8">
<h3 id="org471c9b8">連続分布の平均 (つづき)</h3>
<ul>
<li><p>
確率変数の変換 \(\varphi(X)\) の期待値:
</p>
<div>
\begin{equation}
  \mathbb{E}[\varphi(X)]:=\int_{-\infty}^\infty\varphi(x)f(x)dx
\end{equation}

</div></li>

<li><p>
\(p\) 次の <b>モーメント</b> (あるいは <b>積率</b> ):
</p>
<div>
\begin{equation}
  \mathbb{E}[X^p]=\int_{-\infty}^\infty x^pf(x)dx
\end{equation}

</div></li>

<li><b>注:</b>
\(X\) が正整数 \(p\) 次のモーメントをもてば，
\(q\leq p\) なるすべての正整数 \(q\) 次のモーメントをもつ</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org65d8734">
<h3 id="org65d8734">連続分布の分散</h3>
<ul>
<li><p>
分散:
</p>
<div>
\begin{align}
  \mathrm{Var}(X):=& \mathbb{E}[(X-\mathbb{E}[X])^2]=\mathbb{E}[X^2]-\mathbb{E}[X]^2\\
  =&\int_{-\infty}^\infty(x-\mathbb{E}[X])^2f(x)dx
\end{align}

</div></li>

<li><b>注:</b> \(X\) が2次のモーメントをもつときのみ定義できる</li>
<li>分散の平方根 \(\sqrt{\mathrm{Var}(X)}\) を <b>標準偏差</b> と呼ぶ</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org7cffece">
<h2 id="org7cffece">一様分布</h2>
<div class="outline-text-2" id="text-org7cffece">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgdfe182e">
<h3 id="orgdfe182e">一様分布の密度関数</h3>
<ul>
<li>区間 \((a,b)\) 上の一様分布: \(U(a,b)\) <br />
区間 \((a,b)\) のランダムな値の選択を表す分布</li>
<li><p>
確率密度関数:
</p>
<div>
\begin{equation}
  f(x)=
  \begin{cases}
    \frac{1}{b-a} & (a < x < b)\\
    0 & (\text{上記以外のとき})
  \end{cases}
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org84cac60">
<h3 id="org84cac60">一様分布の平均</h3>
<ul>
<li><p>
平均:
</p>
<div>
\begin{align}
  \mathbb{E}[X]
  &=\int_{-\infty}^\infty xf(x)dx
    =\frac{1}{b-a}\int_a^bxdx\\
  &=\frac{b^2-a^2}{2(b-a)}
    =\frac{a+b}{2}
\end{align}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgbe9ddc9">
<h3 id="orgbe9ddc9">一様分布の分散</h3>
<ul>
<li><p>
2次モーメント:
</p>
<div>
\begin{align}
  \mathbb{E}[X^2]
  &=\int_{-\infty}^\infty x^2f(x)dx
    =\frac{1}{b-a}\int_a^bx^2dx\\
  &=\frac{b^3-a^3}{3(b-a)}
    =\frac{a^2+ab+b^2}{3}
\end{align}

</div></li>

<li><p>
分散:
</p>
<div>
\begin{align}
  \mathrm{Var}(X)
  &=\mathbb{E}[X^2]-\mathbb{E}[X]^2
  % =\frac{a^2+ab+b^2}{3}-\frac{a^2+2ab+b^2}{4}\\
  % &=\frac{a^2-2ab+b^2}{12}
      =\frac{(b-a)^2}{12}
\end{align}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3ba740a">
<h3 id="org3ba740a">実行例: <code>dist-unif.r</code></h3>
<ul>
<li>一様分布に従う乱数の発生は <code>runif()</code> を用いる</li>
<li>一様分布の確率密度関数は <code>dunif()</code> で計算できる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org7537f48">
<h2 id="org7537f48">正規分布</h2>
<div class="outline-text-2" id="text-org7537f48">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org3e501e8">
<h3 id="org3e501e8">正規分布の密度関数</h3>
<ul>
<li>平均 \(\mu\) , 分散 \(\sigma^2\) の正規分布: \(N(\mu,\sigma^2)\) <br />
(\(\mu\) は実数, \(\sigma\) は正の実数)</li>
<li><p>
確率密度関数:
</p>
<div>
\begin{equation}
  f(x)=\frac{1}{\sqrt{2\pi\sigma^2}}\exp\Bigl(-\frac{(x-\mu)^2}{2\sigma^2}\Bigr)
\end{equation}

</div></li>

<li>平均0, 分散1の正規分布を <b>標準正規分布</b> と呼ぶ</li>
<li><b>Gauss分布</b> と呼ぶこともある</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf4de475">
<h3 id="orgf4de475">実行例: <code>dist-norm.r</code></h3>
<ul>
<li>物理実験等の観測誤差の分布はしばしば正規分布でモデル化される</li>
<li>真の平均を標本平均で推定した際の推定誤差の確率分布は，
サンプル数が大きくなるに従って正規分布に近づいていく(中心極限定理)</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org0fa2b7c" data-background="#fef4f4">
<h3 id="org0fa2b7c">演習</h3>
<ul>
<li><p>
\(U_{1},U_{2}\) を \((0,1)\) 上の一様分布に従う独立な確率変数とする．
このとき
</p>
<div>
\begin{align}
  X_{1}&=\sqrt{-2\log(U_{1})}\cos(2\pi U_{2}),\\
  X_{2}&=\sqrt{-2\log(U_{1})}\sin(2\pi U_{2})
\end{align}

</div>

<p>
とおくと，
\(X_{1},X_{2}\) は独立かつともに標準正規分布に従う．
これを実行例を参考にしながらグラフに描画して確認せよ. <br />
(この変換をBox-Muller変換と呼ぶ)
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org82e4069">
<h3 id="org82e4069">正規分布の特徴</h3>
<ul>
<li>中心極限定理の特殊な形 (de Moivre-Laplaceの定理)
<ul>
<li>\(X_{1},\dotsc,X_n\) を成功確率 \(p\) のBernoulli分布に従う
独立同分布な確率変数列とする</li>
<li>\(Y=\sum_{i=1}^nX_i\) は試行回数 \(n\) , 成功確率 \(p\) の二項分布に従う</li>
<li>Bernoulli分布は平均 \(p\) , 分散 \(p(1-p)\) である</li>
<li><p>
中心極限定理により
</p>
<div>
\begin{equation}
  \frac{\sum_{i=1}^nX_i-np}{\sqrt{np(1-p)}}
  =\frac{\sqrt{n}(\frac{1}{n}\sum_{i=1}^nX_i-p)}{\sqrt{p(1-p)}}
  =\frac{Y-np}{\sqrt{np(1-p)}}
\end{equation}

</div>

<p>
の分布は標準正規分布で近似できる
</p></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org73f0ead">
<h3 id="org73f0ead">二項分布の近似</h3>
<ul>
<li>正規近似の例: <code>dist-binom-norm.r</code></li>
<li>Poisson近似の例: <code>dist-binom-pois.r</code></li>
<li>\(p\) が非常に小さい場合，
特に \(np\) がそれほど大きくならない程度に \(p\) が小さい場合は，
\((Y-np)/\sqrt{np(1-p)}\) の分布の正規近似よりも，
\(Y\) の分布は強度 \(np\) のPoisson分布による近似の方が精度がよい (少数の法則)</li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgefebd37">
<h2 id="orgefebd37">ガンマ分布</h2>
<div class="outline-text-2" id="text-orgefebd37">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgdea1d88">
<h3 id="orgdea1d88">ガンマ分布の密度関数</h3>
<ul>
<li>パラメータ \(\nu\) , \(\alpha\) のガンマ分布: 
\(\Gamma(\nu,\alpha)\) または \(G(\alpha,\nu)\) <br />
(\(\nu\) , \(\alpha\) は正の実数)</li>
<li><p>
確率密度関数:
</p>
<div>
\begin{equation}
  f(x)=
  \begin{cases}
    \frac{\alpha^\nu }{\Gamma(\nu)}
    x^{\nu-1}e^{-\alpha x}&(x>0)\\
    0&(x\leq0)
  \end{cases}
\end{equation}

</div>

<p>
ただしガンマ関数 \(\Gamma(\nu)\) は以下で定義される:
</p>
<div>
\begin{equation}
  \Gamma(\nu)=\int_0^\infty x^{\nu-1}e^{-x}dx
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org11258f2">
<h3 id="org11258f2">実行例: <code>dist-gamma.r</code></h3>
<ul>
<li>\(\nu,\alpha\) はそれぞれ <b>形状パラメータ</b> ， <b>レート</b> と呼ばれることがある</li>
<li>平均は \(\nu/\alpha\) , 分散は \(\nu/\alpha^2\) で与えられる</li>
<li>ガンマ分布は応用上重要な確率分布を含む
<ul>
<li>指数分布</li>
<li>\(\chi^2\) 分布</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org06a3d93">
<h3 id="org06a3d93">指数分布</h3>
<ul>
<li><p>
パラメータ \(\lambda\) の指数分布: \(\mathrm{Exp}(\lambda)\) <br />
(\(\lambda\) は正の実数)
</p>
<div>
\begin{equation}
  f(x)=\Gamma(1,\lambda)=
  \begin{cases}
    \lambda e^{-\lambda x}&(x>0)\\
    0&(x\leq0)
  \end{cases}
\end{equation}

</div></li>

<li>\(\lambda\) は <b>レート</b> と呼ばれることがある</li>
<li>平均，分散はそれぞれ \(\lambda^{-1}\) , \(\lambda^{-2}\) で与えられる</li>
<li>実行例: <code>dist-exp.r</code></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org8fad280">
<h3 id="org8fad280">\(\chi^2\) 分布</h3>
<ul>
<li><p>
自由度 \(k\) の \(\chi^2\) 分布: \(\chi^2(k)\) <br />
(\(k\) は正の実数)
</p>
<div>
\begin{equation}
  f(x)=\Gamma(k/2,1/2)=
  \begin{cases}
    \frac{1}{2^{k/2}\Gamma(k/2)}
    x^{k/2-1}e^{-x/2}&(x>0)\\
    0&(x\leq0)
  \end{cases}
\end{equation}

</div></li>

<li>\(\chi^2\) は <b>カイ二乗</b> と読む</li>
<li>平均, 分散はそれぞれ \(k\) , \(2k\) で与えられる</li>
<li>実行例: <code>dist-chisq.r</code></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org90e27e8">
<h3 id="org90e27e8">\(\chi^2\) 分布の特徴 <code>dist-chisq-norm.r</code></h3>
<ul>
<li>標準正規分布に従う \(k\) 個の独立な確率変数の
二乗和は自由度 \(k\) の \(\chi^2\) 分布に従う</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org474b794">
<h2 id="org474b794">\(t\) 分布</h2>
<div class="outline-text-2" id="text-org474b794">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org2c1d853">
<h3 id="org2c1d853">\(t\) 分布の密度関数</h3>
<ul>
<li>自由度 \(\nu\) の(Studentの) \(t\) 分布: \(t(\nu)\) <br />
(\(\nu\) は正の実数)</li>
<li><p>
確率密度関数:
</p>
<div>
\begin{equation}
  f(x)=
  \frac{1}{\sqrt{\pi \nu}}
  \frac{\Gamma((\nu+1)/2)}{\Gamma(\nu/2)}
  \left(1+\frac{x^2}{\nu}\right)^{-(\nu+1)/2}
\end{equation}

</div></li>

<li><b>Student</b> は \(t\) 分布を導入した統計学者Gossetのペンネーム</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc1bea98">
<h3 id="orgc1bea98">\(t\) 分布の平均と分散</h3>
<ul>
<li><p>
平均:
</p>
<div>
\begin{equation}
  \mathbb{E}[X]
  =0 \quad\text{(ただし$\nu>1$)}
\end{equation}

</div></li>

<li><p>
分散:
</p>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\frac{\nu}{\nu-2} \quad\text{(ただし $\nu>2$)}
\end{equation}

</div></li>

<li>実行例: <code>dist-t.r</code></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgea513a0">
<h3 id="orgea513a0">\(t\) 分布の特徴 <code>dist-t-norm.r</code></h3>
<ul>
<li><p>
\(Z\) を標準正規分布に従う確率変数，
\(Y\) を自由度 \(k\) の \(\chi^2\) 分布に従う確率変数とし，
\(Z,Y\) は独立であるとする．
このとき，確率変数
</p>
<div>
\begin{equation}
  \frac{Z}{\sqrt{Y/k}}
\end{equation}

</div>

<p>
は自由度 \(k\) の \(t\) 分布に従う
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org1175e3a">
<h2 id="org1175e3a">\(F\) 分布</h2>
<div class="outline-text-2" id="text-org1175e3a">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgd8acb6a">
<h3 id="orgd8acb6a">\(F\) 分布の密度関数</h3>
<ul>
<li>自由度 \(\nu_{1},\nu_{2}\) の \(F\) 分布: \(F(\nu_{1},\nu_{2})\) <br />
(\(\nu_{1},\nu_{2}\) は正の実数)</li>
<li><p>
確率密度関数:
</p>
<div>
\begin{equation}
  f(x)=
  \begin{cases}
    \frac{(\nu_{1}/\nu_{2})^{\nu_{1}/2}}{B(\nu_{1}/2,\nu_{2}/2)}
    \frac{x^{\nu_{1}/2-1}}{(1+\nu_{1}x/\nu_{2})^{(\nu_{1}+\nu_{2})/2}}&(x>0)\\
    0&(x\leq0)
  \end{cases}
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org18c8618">
<h3 id="org18c8618">\(F\) 分布の平均と分散</h3>
<ul>
<li><p>
平均: 
</p>
<div>
\begin{equation}
  \mathbb{E}[X]
  =\frac{\nu_{2}}{\nu_{2}-2} \quad \text{(ただし$\nu_{2}>2$)}
\end{equation}

</div></li>

<li><p>
分散:
</p>
<div>
\begin{equation}
  \mathrm{Var}(X)
  =\frac{2\nu_{2}^2(\nu_{1}+\nu_{2}-2)}{\nu_{1}(\nu_{2}-2)^2(\nu_{2}-4)}
  \quad\text{(ただし$\nu_{2}>4$)}
\end{equation}

</div></li>

<li>実行例: <code>dist-F.r</code></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgcdc1fcf">
<h3 id="orgcdc1fcf">\(F\) 分布の特徴 <code>dist-F-norm.r</code></h3>
<ul>
<li><p>
\(Y_{1},Y_{2}\) をそれぞれ自由度 \(k_{1},k_{2}\) の \(\chi^2\) 分布に従う独立な
確率変数とする．このとき, 確率変数
</p>
<div>
\begin{equation}
  \frac{Y_{1}/k_{1}}{Y_{2}/k_{2}}
\end{equation}

</div>

<p>
は自由度 \(k_{1},k_{2}\) の \(F\) 分布に従う
</p></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/lib/js/head.min.js"></script>
<script src="./reveal.js/js/reveal.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: true,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,

overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'fade', // see README of reveal.js for options
transitionSpeed: 'default',

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/audio-slideshow/audio-slideshow.js', condition: function( ) { return !!document.body.classList && !Reveal.isSpeakerNotes(); } },
{ src: './reveal.js/plugin/anything/anything.js' },
{ src: './reveal.js/plugin/toc-progress/toc-progress.js', async: true, callback: function() { toc_progress.initialize('reduce', 'rgba(120,138,130,0.2)'); toc_progress.create(); } },
{ src: './reveal.js/plugin/jump/jump.js', async: true },
{ src: './reveal.js/plugin/quiz/js/quiz.js', async: true, callback: function() { prepareQuizzes({preventUnanswered: true, skipStartButton: true}); } },
{ src: './reveal.js/plugin/coursemod/coursemod.js', async: true },
{ src: './reveal.js/plugin/accessibility/helper.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }]

,audioStartAtFragment: true,
  audio: {
    advance: -1, autoplay: false, defaultDuration: 0, defaultAudios: false, playerOpacity: 0.8, playerStyle: 'position: fixed; bottom: 9.5vh; left: 0%; width: 30%; height:30px; z-index: 33;' },
anything: [
        // Following initialization code for class animate from anything-demo.html.
        // Copyright (c) 2016 Asvin Goel, under The MIT License (MIT).
	{className: "animate",  initialize: (function(container, options){
		Reveal.addEventListener( 'fragmentshown', function( event ) {
			if (typeof event.fragment.beginElement === "function" ) {
				event.fragment.beginElement();
			}
		});
		Reveal.addEventListener( 'fragmenthidden', function( event ) {
			if (event.fragment.hasAttribute('data-reverse') ) {
				var reverse = event.fragment.parentElement.querySelector('[id=\"' + event.fragment.getAttribute('data-reverse') + '\"]');
				if ( reverse && typeof reverse.beginElement === "function" ) {
					reverse.beginElement();
				}
			}
		});
		if ( container.getAttribute("data-svg-src") ) {
			var xhr = new XMLHttpRequest();
			xhr.onload = function() {
				if (xhr.readyState === 4) {
					var svg = container.querySelector('svg');
					container.removeChild( svg );
					container.innerHTML = xhr.responseText + container.innerHTML;
					if ( svg ) {
						container.querySelector('svg').innerHTML = container.querySelector('svg').innerHTML + svg.innerHTML;
					}
				}
				else {
					console.warn( "Failed to get file. ReadyState: " + xhr.readyState + ", Status: " + xhr.status);
				}
			};
			xhr.open( 'GET', container.getAttribute("data-svg-src"), true );
			xhr.send();
		}
	}) },
	{className: "randomPic",
	 defaults: {imgalt: "Dummy alt text",
		    imgcaption: "Image by {name}",
		    choices: [ {name: "dummyname", path: "dummypath"} ]},
	 initialize: (function(container, options){
	     var choice = Math.trunc( Math.random()*(options.choices.length) );
	     var img = "<img src='" + options.choices[choice].path + "' alt='" + options.choices[choice].imgalt + "' />";
	     var caption = options.imgcaption.replace(new RegExp('\{name\}', 'gm'), options.choices[choice].name);
	     container.innerHTML = img + caption;
	 }) },
	{className: "notes",
	 initialize: (function(container, options){
	     container.addEventListener('click', function(e) { RevealNotes.open(); });
	 }) }
],
coursemod: { enabled: true, shown: false },
});
</script>
</body>
</html>
