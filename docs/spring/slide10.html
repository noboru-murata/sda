<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>検定</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/css/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/lib/font/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./myconf.css"/>
<link rel="stylesheet" href="./reveal.js/lib/css/zenburn.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = './reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">検定</h1>
</div>
<div class="talk-subtitle">
    <p>仮説の正当性をデータから検証する</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  2020.06.26</p>
</div>

</section>

<section>
<section id="slide-org781e814">
<h2 id="org781e814">検定とは</h2>
<div class="outline-text-2" id="text-org781e814">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org595abba">
<h3 id="org595abba">統計的仮説検定</h3>
<ul>
<li><p>
ある現象・母集団に対して仮定された仮説の真偽を，
データに基づいて統計的に検証する方法
</p>
<blockquote>
<p>
例: 
新しい薬の効能が古い薬よりも優れていること(仮説)を
薬の治験結果(データ)から検証したい
</p>
</blockquote></li>
<li>推定と大きく異なるのは, 
母集団の分布に対して何らかの <b>仮説</b> を考えるところ</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf94d0a3">
<h3 id="orgf94d0a3">検定の基本的手続き</h3>
<ul>
<li>仮説を立てる</li>
<li>仮説が正しい場合に <b>検定統計量</b> が従う標本分布を調べる</li>
<li>実際のデータから検定統計量の値を計算する</li>
<li>計算された検定統計量の値は
仮説が正しいと考えるに十分高い確率で
起こるかどうかを判断する</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org863908a">
<h3 id="org863908a">検定の用語</h3>
<ul>
<li><p>
<b>帰無仮説</b>
</p>
<blockquote>
<p>
検定統計量の分布を予想するために立てる仮説
</p>
</blockquote></li>
<li><p>
<b>対立仮説</b>
</p>
<blockquote>
<p>
「帰無仮説が誤っているときに起こりうるシナリオ」として想定する仮説
</p>
</blockquote>
<ul>
<li>慣習として
帰無仮説を <b>\(H_0\)</b>, 
対立仮説を <b>\(H_1\)</b> で表す</li>
<li>「帰無仮説を捨てて無に帰する」ことを期待する場合が多い</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb273306">
<h3 id="orgb273306">帰無仮説と対立仮説</h3>
<ul>
<li>例: 薬の治験 (単純な場合)
<ul>
<li>帰無仮説 \(H_0\): 新しい薬も古い薬も効能は同じ</li>
<li>対立仮説 \(H_1\): 新しい薬と古い薬の効能は異なる</li>

</ul></li>
<li>例: 薬の治験 (新薬がより良いことを期待する場合)
<ul>
<li>帰無仮説 \(H_0\): 新しい薬も古い薬も効能は同じ</li>
<li>対立仮説 \(H_1\): 新しい薬の方が古い薬より効能が高い</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb65193a">
<h3 id="orgb65193a">検定の準備</h3>
<ul>
<li><p>
帰無分布
</p>
<blockquote>
<p>
帰無仮説が正しい場合に検定統計量が従う分布
</p>
</blockquote></li>
<li><p>
棄却域
</p>
<blockquote>
<p>
帰無仮説の下で統計量の取り得るべき範囲の外の領域
</p>
</blockquote></li>
<li>仮説検定
<ul>
<li>帰無仮説を <b>棄却</b>: 帰無仮説は誤っていると判断すること</li>
<li>帰無仮説を <b>受容</b>: 帰無仮説を積極的に棄却できないこと</li>

</ul></li>
<li>検定の誤り
<ul>
<li><b>第一種過誤</b>: 「正しい帰無仮説を棄却する」誤り</li>
<li><b>第二種過誤</b>: 「誤った帰無仮説を受容する」誤り</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org782836d">
<h3 id="org782836d">検定の設計指針</h3>
<ul>
<li>検定統計量 \(T\) に対して棄却域 \(R\) を設計
<ul>
<li><p>
<b>サイズ</b>: 第一種過誤が <b>起きる確率</b>
</p>
<div>
\begin{equation}
  \text{(サイズ)}
  =P(\text{$T$ が$R$に含まれる}|\text{帰無仮説が正しい})
\end{equation}

</div></li>

<li><p>
<b>検出力</b>: 第二種過誤が <b>起きない確率</b>
</p>
<div>
\begin{equation}
  \text{(検出力)}
  =P(\text{$T$ が$R$に含まれる}|\text{対立仮説が正しい})
\end{equation}

</div></li>

</ul></li>

<li><p>
<b>有意水準</b>
</p>
<blockquote>
<p>
第一種過誤が起きる確率(サイズ)として許容する上限
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge20a870">
<h3 id="orge20a870">棄却域の決め方</h3>
<ul>
<li>検定を構成する場合の一般的な戦略: <br />
棄却域 \(R_{\alpha}\) は以下のように設定する
<ul>
<li><b>サイズを小さく</b> (有意水準 \(\alpha\) 以下に) 抑える</li>
<li><p>
可能な限り <b>検出力を大きく</b> する
</p>
<div>
\begin{align}
  P(T \in R_{\alpha}|\text{帰無仮説が正しい})
    &\le\alpha\\
  P(T \in R_{\alpha}|\text{対立仮説が正しい})
    &\to\text{最大化}
\end{align}

</div></li>

</ul></li>

<li>対立仮説によって棄却域の形は変わり得る</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org058e92b">
<h3 id="org058e92b">\(p\) 値 (有意確率)</h3>
<ul>
<li><p>
帰無分布における検定統計量の評価:
</p>
<blockquote>
<p>
検定統計量の値が棄却域に含まれる有意水準の最小値を考える
</p>
</blockquote></li>
<li><p>
<b>\(p\) 値 (有意確率)</b>: (検定統計量 \(T\), 棄却域 \(R_{\alpha}\))
</p>
<div>
\begin{equation}
  \text{($p$ 値)}
  =\min\{\alpha\in(0,1)|\text{$T$ が$R_{\alpha}$に含まれる}\}
\end{equation}

</div></li>

<li>\(p\) 値が有意水準未満のときに帰無仮説を棄却する</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org04ef1a3">
<h3 id="org04ef1a3">検定に関する注意</h3>
<ul>
<li><p>
帰無仮説の受容の意味:
</p>
<blockquote>
<p>
帰無仮説が正しいと仮定しても矛盾は生じない
</p>

<p>
帰無仮説の正しさを積極的に支持する結果ではない
</p>
</blockquote></li>
<li><p>
第二種過誤:
</p>
<blockquote>
<p>
一般に第二種過誤の起こる確率については何ら仮定がないため，
その確率は非常に大きい可能性がある
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org2be6820">
<h2 id="org2be6820">正規母集団に対する　検定 (1標本)　</h2>
<div class="outline-text-2" id="text-org2be6820">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org8720999">
<h3 id="org8720999">1標本データに対する仮定</h3>
<ul>
<li>観測データは独立同分布な確率変数列
\(X_1,X_2,\dotsc,X_n\)</li>
<li>\(X_{i}\) は平均 \(\mu\), 分散 \(\sigma^2\) の正規分布に従う</li>
<li>以下では \(\mu\) および分散 \(\sigma^2\) に対する検定を説明</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgd9af4c4">
<h2 id="orgd9af4c4">平均の検定</h2>
<div class="outline-text-2" id="text-orgd9af4c4">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org13a2967">
<h3 id="org13a2967">平均の検定  (両側検定)</h3>
<ul>
<li>\(\mu_0\) を既知の定数として，
平均 \(\mu\) が真の平均 \(\mu_0\) であるか否かを検定する
<ul>
<li>帰無仮説: \(\mu=\mu_0\)</li>
<li><p>
対立仮説: \(\mu\neq\mu_0\)
</p>
<div>
\begin{equation}
  H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu\neq\mu_0.
\end{equation}

</div></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org51ad071">
<h3 id="org51ad071">考え方</h3>
<ul>
<li><p>
標本平均 \(\bar{X}\) が
真の平均 \(\mu_0\) とどの程度離れているかを検証する
</p>
<ul>
<li><p>
標本平均: (正規分布に従う)
</p>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div></li>
<li><p>
不偏分散: (\(\chi^2\) 分布に従う)
</p>
<div>
\begin{equation}
  s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2
\end{equation}

</div></li>

</ul>
<p>
の性質を用いて検定統計量を構成する
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf6c65ed">
<h3 id="orgf6c65ed">考え方 (つづき)</h3>
<ul>
<li><p>
検定統計量: 
</p>
<div>
\begin{equation}
  t=\frac{\sqrt{n}(\bar{X}-\mu_0)}{s}
\end{equation}

</div></li>
<li>帰無仮説 \(H_0\) が正しいならば \(t\) は自由度 \(n{-}1\) の \(t\) 分布に従う</li>
<li>帰無分布が \(t\) 分布となるので <b>Studentの \(t\) 検定</b> と呼ばれる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgeb704b6">
<h3 id="orgeb704b6">棄却域の取り方</h3>
<ul>
<li>有意水準: \(\alpha\in(0,1)\)</li>
<li>自由度 \(n{-}1\) の \(t\) 分布の
\(1{-}\alpha/2\) 分位点: \(t_{1{-}\alpha/2}(n{-}1)\)</li>
<li><p>
\(H_0\) の下で以下が成立:
</p>
<div>
\begin{equation}
  P(|t|>t_{1{-}\alpha/2}(n{-}1))=\alpha
\end{equation}

</div></li>
<li><p>
第一種過誤の上限が \(\alpha\) の棄却域:
</p>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,-t_{1{-}\alpha/2}(n{-}1)\right)
  \cup\left(t_{1{-}\alpha/2}(n{-}1),\infty\right)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org753b848">
<h3 id="org753b848">検定の手順 (棄却域を用いる場合)</h3>
<ul>
<li>データから検定統計量 \(t\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却:
</p>
<div>
\begin{equation}
  |t|>t_{1{-}\alpha/2}(n{-}1)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf8de7e6">
<h3 id="orgf8de7e6">検定の手順 (\(p\) 値を用いる場合)</h3>
<ul>
<li><p>
\(p\) 値を計算: ( \(f(x)\):自由度 \(n{-}1\) の \(t\) 分布の密度)
</p>
<div>
\begin{equation}
  \text{($p$ 値)}
  =2\int_{|t|}^\infty f(x)dx
\end{equation}

</div></li>
<li><p>
\(p\) 値が \(\alpha\) 未満なら帰無仮説を棄却:
</p>
<div>
\begin{align}
  |t|>t_{1{-}\alpha/2}(n{-}1)
  &\Leftrightarrow
    \int_{-\infty}^{|t|}f(x)dx>1{-}\alpha/2\\
  &\Leftrightarrow
    2\int_{|t|}^\infty f(x)dx < \alpha
\end{align}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3280c25">
<h3 id="org3280c25">対立仮説の違い</h3>
<ul>
<li>例: 薬の治験 <br />
観測データ \(X_1,X_2,\dotsc,X_n\) (\(n\) 人の被験者の治験結果)
に対する仮説:
<ul>
<li>古い薬(高価)と新しい薬(安価)の効能が変わらない</li>
<li>古い薬に比べて新しい薬の効能が改善した</li>

</ul></li>
<li>対立仮説の立て方によって棄却域の形は変わりうる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org8826779">
<h3 id="org8826779">平均の検定 (片側検定)</h3>
<ul>
<li><p>
\(\mu_0\) を既知の定数として，
平均 \(\mu\) が真の平均 \(\mu_0\) より大きいかを検定する
</p>
<ul>
<li>帰無仮説: \(\mu=\mu_0\)</li>
<li>対立仮説: \(\mu>\mu_0\)</li>

</ul>
<div>
\begin{equation}
  H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu>\mu_0.
\end{equation}

</div></li>
<li>検定統計量の標本分布:
<ul>
<li>帰無仮説は同一なので検定統計量 \(t\) の帰無分布も同一となる</li>
<li>対立仮説の下で \(t\) の値が正の方向に大きくなると期待される</li>

</ul></li>
<li>棄却域 &ldquo;\(t>c\)&rdquo; (\(c\) は正の数) を考えるのが自然</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org92babdc">
<h3 id="org92babdc">棄却域の取り方</h3>
<ul>
<li>有意水準: \(\alpha\in(0,1)\)</li>
<li>自由度 \(n{-}1\) の \(t\) 分布の \(1{-}\alpha\) 分位点:
\(t_{1{-}\alpha}(n{-}1)\)</li>
<li><p>
\(H_0\) の下で以下が成立:
</p>
<div>
\begin{equation}
  P(t>t_{1{-}\alpha}(n{-}1))=\alpha
\end{equation}

</div></li>
<li><p>
第一種過誤の上限が \(\alpha\) の棄却域:
</p>
<div>
\begin{equation}
  R_{\alpha}=
  \left(t_{1{-}\alpha}(n{-}1),\infty\right)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3cd7d6b">
<h3 id="org3cd7d6b">検定の手順 (棄却域を用いる場合)</h3>
<ul>
<li>データから検定統計量 \(t\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却:
</p>
<div>
\begin{equation}
  t>t_{1{-}\alpha}(n{-}1)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org5497189">
<h3 id="org5497189">検定の手順 (\(p\) 値を用いる場合)</h3>
<ul>
<li><p>
\(p\) 値を計算: ( \(f(x)\):自由度 \(n{-}1\) の \(t\) 分布の密度)
</p>
<div>
\begin{equation}
  \text{($p$ 値)}=
  \int_{t}^\infty f(x)dx
\end{equation}

</div></li>
<li>\(p\) 値が \(\alpha\) 未満なら帰無仮説を棄却</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org46c410f">
<h3 id="org46c410f">両側検定と片側検定</h3>
<ul>
<li><b>右片側検定</b>: 棄却域がある定数 \(a\) によって \((a,\infty)\)</li>
<li><b>左片側検定</b>: 棄却域がある定数 \(a\) によって \((-\infty,a)\)
<ul>
<li>右片側検定と左片側検定を合わせて <b>片側検定</b> と呼ぶ</li>

</ul></li>
<li><b>両側検定</b>: 棄却域がある定数 \(a < b\) によって \((-\infty,a)\cup(b,\infty)\)</li>
<li>平均の検定の場合:
<ul>
<li>対立仮説を \(H_1:\mu\neq\mu_0\) にとった場合は両側検定</li>
<li>対立仮説を \(H_1:\mu>\mu_0\) にとった場合は右片側検定</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org59eb2dc">
<h3 id="org59eb2dc">平均の検定 (片側検定)</h3>
<ul>
<li><p>
反対向きの対立仮説 \(\mu < \mu_0\) を考えた検定
</p>
<div>
\begin{equation}
  H_0:\mu=\mu_0\quad\text{vs}\quad H_1:\mu < \mu_0.
\end{equation}

</div></li>
<li>自由度 \(n{-}1\) の \(t\) 分布の \(\alpha\) 分位点:
\(t_{\alpha}(n{-}1)\)</li>
<li><p>
以下の場合，帰無仮説を棄却 (左片側検定):
</p>
<div>
\begin{equation}
  t < t_{\alpha}(n{-}1)
\end{equation}

</div></li>
<li><p>
以下の \(p\) 値が \(\alpha\) 未満なら帰無仮説を棄却:
</p>
<div>
\begin{equation}
  \text{($p$ 値)}
  =\int_{-\infty}^t f(x)dx
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org3ffeb32" data-background="#fef4f4">
<h3 id="org3ffeb32">演習</h3>
<ul>
<li><code>test-mean.r</code> を確認しなさい．</li>
<li><code>test-region.r</code> を確認しなさい．</li>
<li>自身で収集したデータについて，
平均値に関する検定を行いなさい．</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgfb51fbd">
<h2 id="orgfb51fbd">分散の検定</h2>
<div class="outline-text-2" id="text-orgfb51fbd">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgd8470f9">
<h3 id="orgd8470f9">分散の検定 (両側検定)</h3>
<ul>
<li><p>
\(\sigma_0^2\) を既知の定数として，
分散 \(\sigma^2\) が \(\sigma_0^2\) であるか否かを検定する
</p>
<ul>
<li>帰無仮説: \(\sigma^2=\sigma_0^2\)</li>
<li>対立仮説: \(\sigma^2\neq\sigma_0^2\)</li>

</ul>
<div>
\begin{equation}%\label{two-side}
  H_0:\sigma^2=\sigma_0^2\quad\text{vs}\quad H_1:\sigma^2\neq\sigma_0^2
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org67ab008">
<h3 id="org67ab008">考え方</h3>
<ul>
<li><p>
不偏分散 \(s^2\) が
真の分散 \(\sigma_{0}^{2}\) とどの程度離れているかを検証する
</p>
<ul>
<li><p>
不偏分散: (\(\chi^2\) 分布に従う)
</p>
<div>
\begin{equation}
 s^2=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2 
\end{equation}

</div></li>

</ul>
<p>
の性質を用いて検定統計量を構成する
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org15da877">
<h3 id="org15da877">考え方 (つづき)</h3>
<ul>
<li><p>
検定統計量:
</p>
<div>
\begin{equation}
  \chi^2=(n{-}1)s^2/\sigma_0^2
\end{equation}

</div></li>
<li>帰無仮説 \(H_0\) が正しいならば \(\chi^2\) は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う</li>
<li>帰無分布が \(\chi^2\) 分布となるので <b>\(\chi^2\) 検定</b> と呼ばれる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org64b560f">
<h3 id="org64b560f">棄却域の取り方</h3>
<ul>
<li>有意水準: \(\alpha\in(0,1)\)</li>
<li>自由度 \(n{-}1\) の \(\chi^2\) 分布の
\(\alpha/2\) 分位点:
\(\chi^2_{\alpha/2}(n{-}1)\)</li>
<li>自由度 \(n{-}1\) の \(\chi^2\) 分布の
\(1{-}\alpha/2\) 分位点:
\(\chi^2_{1{-}\alpha/2}(n{-}1)\)</li>
<li><p>
\(H_0\) の下で以下が成立:
</p>
<div>
\begin{equation}
  P(\chi^2 < \chi^2_{\alpha/2}(n{-}1)
  \text{ または }\chi^2>\chi^2_{1{-}\alpha/2}(n{-}1))
  =\alpha
\end{equation}

</div></li>
<li><p>
第一種過誤の上限が \(\alpha\) となる棄却域:
</p>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,\chi^2_{\alpha/2}(n{-}1)\right)
  \cup\left(\chi^2_{1{-}\alpha/2}(n{-}1),\infty\right)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgbfd0fc9">
<h3 id="orgbfd0fc9">検定の手順 (棄却域を用いる場合)</h3>
<ul>
<li>データから検定統計量 \(\chi^2\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却:
</p>
<div>
\begin{equation}
  \chi^2 < \chi^2_{\alpha/2}(n{-}1)
  \text{ または }\chi^2>\chi^2_{1{-}\alpha/2}(n{-}1)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org39a3308">
<h3 id="org39a3308">検定の手順 (\(p\) 値を用いる場合)</h3>
<ul>
<li><p>
\(p\) 値を計算: ( \(f(x)\):自由度 \(n{-}1\) の \(\chi^2\) 分布の密度)
</p>
<div>
\begin{equation}
  \text{($p$ 値)}
  =2\min\left\{\int_0^{\chi^2}f(x)dx,\int_{\chi^2}^\infty f(x)dx\right\}
\end{equation}

</div></li>
<li>\(p\) 値が \(\alpha\) 未満なら帰無仮説を棄却</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgbc7350c">
<h3 id="orgbc7350c">分散の検定 (片側検定)</h3>
<ul>
<li><p>
対立仮説が片側 (右側対立仮説) の場合:
</p>
<ul>
<li>帰無仮説: \(\sigma^2=\sigma_0^2\)</li>
<li>対立仮説: \(\sigma^2>\sigma_0^2\)</li>

</ul>
<div>
\begin{equation}%\label{two-side}
  H_0:\sigma^2=\sigma_0^2\quad
  \text{vs}\quad H_1:\sigma^2>\sigma_0^2
\end{equation}

</div></li>
<li>左側対立仮説 \(H_1:\sigma^2 < \sigma_0^2\) の場合も以下の議論は同様</li>

</ul>


<div class="slide-footer"><br></div>
</section>
<section id="slide-orge8ef305">
<h3 id="orge8ef305">検定の手順 (棄却域を用いる場合)</h3>
<ul>
<li>自由度 \(n{-}1\) の \(\chi^2\) 分布の \(1{-}\alpha\) 分位点:
\(\chi^2_{1{-}\alpha}(n{-}1)\)</li>
<li><p>
以下の場合，帰無仮説を棄却:
</p>
<div>
\begin{equation}
  \chi^2>\chi^2_{1{-}\alpha}(n{-}1)
\end{equation}

</div></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgebb6608">
<h3 id="orgebb6608">検定の手順 (\(p\) 値を用いる場合)</h3>
<ul>
<li><p>
\(p\) 値を計算: ( \(f(x)\):自由度 \(n{-}1\) の \(\chi^2\) 分布の密度)
</p>
<div>
\begin{equation}
  \text{($p$ 値)}
  =\int_{\chi^2}^\infty f(x)dx
\end{equation}

</div></li>
<li>\(p\) 値が \(\alpha\) 未満なら帰無仮説を棄却</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2442848" data-background="#fef4f4">
<h3 id="org2442848">演習 (分散の検定)</h3>
<ul>
<li><code>test-var.r</code> を確認しなさい．</li>
<li>自身で収集したデータについて，
分散に関する検定を行いなさい．</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgd3fff9a">
<h2 id="orgd3fff9a">正規母集団に対する　検定 (2標本)　</h2>
<div class="outline-text-2" id="text-orgd3fff9a">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org34497ac">
<h3 id="org34497ac">2標本データに対する仮定</h3>
<ul>
<li>2種類の観測データ:
<ul>
<li>\(X_1,X_2,\dotsc,X_m\)</li>
<li>\(Y_1,Y_2,\dotsc,Y_n\)</li>

</ul></li>
<li>3つの条件を仮定:
<ul>
<li>\(X_1,X_2,\dotsc,X_m,Y_1,Y_2,\dotsc,Y_n\) は
独立な確率変数列</li>
<li>\(X_1,\dotsc,X_m\) は同分布で，
平均 \(\mu_1\), 分散 \(\sigma_1^2\) の正規分布に従う</li>
<li>\(Y_1,\dotsc,Y_n\) は同分布で，
平均 \(\mu_2\), 分散 \(\sigma_2^2\) の正規分布に従う</li>

</ul></li>
<li>両者の平均や分散が一致するかどうかを検定する問題を考える</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org891fe06">
<h2 id="org891fe06">平均の差の検定</h2>
<div class="outline-text-2" id="text-org891fe06">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge4d35b6">
<h3 id="orge4d35b6">平均の差の検定</h3>
<ul>
<li><p>
2種類のデータの平均が等しいか否かを検定する
</p>
<div>
\begin{equation}%\label{mean-equal}
  H_0:\mu_1=\mu_2\quad\text{vs}\quad H_1:\mu_1\neq\mu_2
\end{equation}

</div></li>
<li><b>Behrens-Fisher問題</b> として知られている</li>
<li>正確かつ適切な検定を導出することは難しい</li>
<li><b>Welch(またはSatterthwaite)の近似法</b>:
<ul>
<li>\(\chi^2\) 分布に従う独立確率変数列の一次結合の分布を，
1つの \(\chi^2\) 分布に従う確率変数の定数倍の分布で近似する方法</li>
<li>平均と分散が元の確率変数と一致するように近似</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgdfccca6">
<h3 id="orgdfccca6">考え方</h3>
<ul>
<li><p>
\(X_1,\dotsc,X_m\) および \(Y_1,\dotsc,Y_m\) の不偏分散:
\(s_1^2\),\(s_2^2\)
</p>
<div>
\begin{equation}
  s_1^2=\frac{1}{m{-}1}\sum_{i=1}^m(X_i-\bar{X})^2,\quad
  s_2^2=\frac{1}{n{-}1}\sum_{i=1}^n(Y_i-\bar{Y})^2.
\end{equation}

</div></li>
<li>標本平均と不偏分散の性質:
<ul>
<li>\(\bar{X}-\bar{Y},s_1^2,s_2^2\) は独立となる</li>
<li>\((m{-}1)s_1^2/\sigma_1^2\)
は自由度 \(m{-}1\) の \(\chi^2\) 分布に従う</li>
<li>\((n{-}1)s_2^2/\sigma_2^2\)
は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org87c6be9">
<h3 id="org87c6be9">Welchの近似法</h3>
<ul>
<li><b>詳細は資料を参照</b></li>
<li>確率変数 \(s_1^2/m+s_2^2/n\) の分布を \(c\chi^2_\nu\) の分布で近似</li>
<li><p>
\(\chi^2_\nu\) は自由度 \(\nu\) の \(\chi^2\) 分布に従う確率変数
</p>
<div>
\begin{equation}
  c=\frac{\frac{(\sigma_1^2/m)^2}{m{-}1}
    +\frac{(\sigma_2^2/n)^2}{n{-}1}}{\sigma_1^2/m+\sigma_2^2/n},\quad
  \nu=\frac{(\sigma_1^2/m+\sigma_2^2/n)^2}{\frac{(\sigma_1^2/m)^2}{m{-}1}
    +\frac{(\sigma_2^2/n)^2}{n{-}1}}
\end{equation}

</div>
<p>
(平均と分散を合わせる)
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgff94dc0">
<h3 id="orgff94dc0">Welchの近似法 (つづき)</h3>
<ul>
<li><p>
検定統計量:
</p>
<div>
\begin{equation}
  t=\frac{\bar{X}-\bar{Y}}{\sqrt{s_1^2/m+s_2^2/n}}
  \simeq\frac{\bar{X}-\bar{Y}}{\sqrt{c\chi^2_\nu}}
\end{equation}

</div></li>
<li>\(\bar{X}-\bar{Y},s_1^2/m+s_2^2/n\) は独立</li>
<li>\(\bar{X}-\bar{Y},c\chi^2_\nu\) も独立とすべき</li>
<li>\(t\) の分布は \((\bar{X}-\bar{Y})/\sqrt{c\chi^2_\nu}\) で近似できる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orged904d8">
<h3 id="orged904d8">帰無分布の近似</h3>
<ul>
<li><p>
データの正規性から以下は標準正規分布に従う
</p>
<div>
\begin{equation}
  \frac{(\bar{X}-\bar{Y})-(\mu_1{-}\mu_2)}
  {\sqrt{\sigma_1^2/m+\sigma_2^2/n}}
\end{equation}

</div></li>
<li><p>
\(H_0\) の下で以下は自由度 \(\nu\) の \(t\) 分布に従う
</p>
<div>
\begin{equation}
  t\simeq
  \frac{\bar{X}-\bar{Y}}{\sqrt{c\chi^2_\nu}}
  \left(=\frac{(\bar{X}-\bar{Y})/\sqrt{\sigma_1^2/m+\sigma_2^2/n}}
    {\sqrt{\frac{c}{\sigma_1^2/m+\sigma_2^2/n}\chi^2_\nu}}\right)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgbfc2215">
<h3 id="orgbfc2215">帰無分布の近似 (つづき)</h3>
<ul>
<li>検定統計量 \(t\) の帰無分布は自由度 \(\nu\) の \(t\) 分布で近似できる</li>
<li><p>
\(\nu\) は未知の分散 \(\sigma_1^2,\sigma_2^2\) を含むので
不偏推定量 \(s_1^2,s_2^2\) で代用して, 
次式で与えられる自由度 \(\hat{\nu}\) を用いる:
</p>
<div>
\begin{equation}
  \hat{\nu}
  =\frac{(s_1^2/m+s_2^2/n)^2}
  {\frac{(s_1^2/m)^2}{m{-}1}+\frac{(s_2^2/n)^2}{n{-}1}}.
\end{equation}

</div></li>
<li>この検定の考え方は <b>Welchの \(t\) 検定</b> と呼ばれる</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgbf53075">
<h3 id="orgbf53075">検定の手順 (棄却域を用いる場合)</h3>
<ul>
<li>有意水準: \(\alpha\in(0,1)\)</li>
<li>自由度 \(\hat{\nu}\) の \(t\) 分布の \(1{-}\alpha/2\) 分位点:
\(t_{1{-}\alpha/2}(\hat{\nu})\)</li>
<li><p>
棄却域:
</p>
<div>
\begin{equation}
  \left(-\infty,-t_{1{-}\alpha/2}(\hat{\nu})\right)
  \cup\left(t_{1{-}\alpha/2}(\hat{\nu}),\infty\right)
\end{equation}

</div></li>
<li><p>
検定統計量 \(t\) の値を計算し，以下の場合，帰無仮説を棄却:
</p>
<div>
\begin{equation}
  |t|>t_{1{-}\alpha/2}(\hat{\nu})
\end{equation}

</div></li>
<li>\(p\) 値の計算や片側対立仮説への対応方法は前と同様</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org81c10f6">
<h3 id="org81c10f6">平均の差の検定 (対応がある場合)</h3>
<ul>
<li>対応がある観測データの平均の差の検定では
2種類のデータ間の自然な対応を考慮することがある</li>
<li>例: 
<ul>
<li>2種類の薬の効能を比較するために被験者に両方の薬を投与</li>
<li>被験者 \(i\) にそれぞれの薬を投与した場合の治験結果: \(X_i,Y_i\)</li>
<li>\(X_i\) と \(Y_i\) には「同一の被験者に対する治験結果」という意味で対応がある</li>

</ul></li>
<li>「対応がある観測値の差の平均が0」という検定を考える</li>
<li>\(Z_i=X_i-Y_i\) \((i=1,\dotsc,n)\) として，
\(Z_1,\dotsc,Z_n\) の平均が0か否かを検定すれば良い</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org42289c8" data-background="#fef4f4">
<h3 id="org42289c8">演習</h3>
<ul>
<li><code>test-diff.r</code> を確認しなさい．</li>
<li><code>test-welch.r</code> を確認しなさい．</li>
<li><code>test-paired.r</code> を確認しなさい．</li>
<li>自身で収集したデータについて，
2標本の平均値の差に関する検定を行いなさい．</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org06501bd">
<h2 id="org06501bd">分散の比の検定</h2>
<div class="outline-text-2" id="text-org06501bd">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org22b8816">
<h3 id="org22b8816">分散の比の検定</h3>
<ul>
<li><p>
2種類のデータの分散が等しいか否かを検定する
</p>
<div>
\begin{equation}%\label{mean-equal}
  H_0:\sigma_1^2=\sigma_2^2\quad\text{vs}\quad H_1:\sigma_1^2\neq\sigma_2^2
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org01b1f96">
<h3 id="org01b1f96">考え方</h3>
<ul>
<li>\(X_1,\dotsc,X_m\) の不偏分散: \(s_1^2\)</li>
<li>\(Y_1,\dotsc,Y_n\) の不偏分散: \(s_2^2\)</li>
<li>このとき \(s_1^2,s_2^2\) は独立でそれぞれ
<ul>
<li>\((m{-}1)s_1^2/\sigma_1^2\)
自由度 \(m{-}1\) の \(\chi^2\) 分布に従う</li>
<li>\((n{-}1)s_2^2/\sigma_2^2\)
は自由度 \(n{-}1\) の \(\chi^2\) 分布に従う</li>

</ul></li>
<li><p>
検定統計量:
</p>
<div>
\begin{equation}
  F=s_1^2/s_2^2
\end{equation}

</div></li>
<li>帰無仮説 \(H_0\) が正しいならば
\(F\) は自由度 \(m{-}1,n{-}1\) の \(F\) 分布に従う</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org08875f1">
<h3 id="org08875f1">棄却域の取り方</h3>
<ul>
<li>有意水準: \(\alpha\in(0,1)\)</li>
<li>自由度 \(m{-}1,n{-}1\) の \(F\) 分布の
\(\alpha/2,\,1{-}\alpha/2\) 分位点:
\(F_{\alpha/2}(m{-}1,n{-}1)\),
\(F_{1{-}\alpha/2}(m{-}1,n{-}1)\)</li>
<li><p>
\(H_0\) の下では以下が成立:
</p>
<div>
\begin{equation}
  P(F < F_{\alpha/2}(m{-}1,n{-}1)
  \text{ または }F > F_{1{-}\alpha/2}(m{-}1,n{-}1))=\alpha
\end{equation}

</div></li>
<li><p>
第一種過誤の上限が \(\alpha\) の棄却域:
</p>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,F_{\alpha/2}(m{-}1,n{-}1)\right)
  \cup\left(F_{1{-}\alpha/2}(m{-}1,n{-}1),\infty\right)
\end{equation}

</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org26aca04">
<h3 id="org26aca04">検定の手順 (棄却域を用いる場合)</h3>
<ul>
<li>データから検定統計量 \(F\) の値を計算</li>
<li><p>
以下の場合，帰無仮説を棄却
</p>
<div>
\begin{equation}
  F < F_{\alpha/2}(m{-}1,n{-}1)
  \text{ または }F>F_{1{-}\alpha/2}(m{-}1,n{-}1)
\end{equation}

</div></li>
<li>\(p\) 値の計算や片側対立仮説への対応方法は前と同様</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgfb2c66c" data-background="#fef4f4">
<h3 id="orgfb2c66c">演習</h3>
<ul>
<li><code>test-ratio.r</code> を確認しなさい．</li>
<li>自身で収集したデータについて，
2標本の分散の比に関する検定を行いなさい．</li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/lib/js/head.min.js"></script>
<script src="./reveal.js/js/reveal.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: true,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,

overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'fade', // see README of reveal.js for options
transitionSpeed: 'default',

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/audio-slideshow/audio-slideshow.js', condition: function( ) { return !!document.body.classList && !Reveal.isSpeakerNotes(); } },
{ src: './reveal.js/plugin/anything/anything.js' },
{ src: './reveal.js/plugin/toc-progress/toc-progress.js', async: true, callback: function() { toc_progress.initialize('reduce', 'rgba(120,138,130,0.2)'); toc_progress.create(); } },
{ src: './reveal.js/plugin/jump/jump.js', async: true },
{ src: './reveal.js/plugin/quiz/js/quiz.js', async: true, callback: function() { prepareQuizzes({preventUnanswered: true, skipStartButton: true}); } },
{ src: './reveal.js/plugin/coursemod/coursemod.js', async: true },
{ src: './reveal.js/plugin/accessibility/helper.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: './reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }]

,audioStartAtFragment: true,
  audio: {
    advance: -1, autoplay: false, defaultDuration: 0, defaultAudios: false, playerOpacity: 0.8, playerStyle: 'position: fixed; bottom: 9.5vh; left: 0%; width: 30%; height:30px; z-index: 33;' },
anything: [
        // Following initialization code for class animate from anything-demo.html.
        // Copyright (c) 2016 Asvin Goel, under The MIT License (MIT).
	{className: "animate",  initialize: (function(container, options){
		Reveal.addEventListener( 'fragmentshown', function( event ) {
			if (typeof event.fragment.beginElement === "function" ) {
				event.fragment.beginElement();
			}
		});
		Reveal.addEventListener( 'fragmenthidden', function( event ) {
			if (event.fragment.hasAttribute('data-reverse') ) {
				var reverse = event.fragment.parentElement.querySelector('[id=\"' + event.fragment.getAttribute('data-reverse') + '\"]');
				if ( reverse && typeof reverse.beginElement === "function" ) {
					reverse.beginElement();
				}
			}
		});
		if ( container.getAttribute("data-svg-src") ) {
			var xhr = new XMLHttpRequest();
			xhr.onload = function() {
				if (xhr.readyState === 4) {
					var svg = container.querySelector('svg');
					container.removeChild( svg );
					container.innerHTML = xhr.responseText + container.innerHTML;
					if ( svg ) {
						container.querySelector('svg').innerHTML = container.querySelector('svg').innerHTML + svg.innerHTML;
					}
				}
				else {
					console.warn( "Failed to get file. ReadyState: " + xhr.readyState + ", Status: " + xhr.status);
				}
			};
			xhr.open( 'GET', container.getAttribute("data-svg-src"), true );
			xhr.send();
		}
	}) },
	{className: "randomPic",
	 defaults: {imgalt: "Dummy alt text",
		    imgcaption: "Image by {name}",
		    choices: [ {name: "dummyname", path: "dummypath"} ]},
	 initialize: (function(container, options){
	     var choice = Math.trunc( Math.random()*(options.choices.length) );
	     var img = "<img src='" + options.choices[choice].path + "' alt='" + options.choices[choice].imgalt + "' />";
	     var caption = options.imgcaption.replace(new RegExp('\{name\}', 'gm'), options.choices[choice].name);
	     container.innerHTML = img + caption;
	 }) },
	{className: "notes",
	 initialize: (function(container, options){
	     container.addEventListener('click', function(e) { RevealNotes.open(); });
	 }) }
],
coursemod: { enabled: true, shown: false },
});
</script>
</body>
</html>
